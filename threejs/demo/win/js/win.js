!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){e.exports=n(4)(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),r=n(5),o=n(6),i=n(7),s=n(8),l=function(){function e(){var e=this;this.scene=new a.Scene,this.camera=new a.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,900),this.renderer=new a.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(new a.Color(9474192)),this.renderer.shadowMap.enabled=!0,document.body.appendChild(this.renderer.domElement),this.orbit=new r.OrbitControls(this.camera,this.renderer.domElement),this.orbit.enabled=!0,this.camera.position.set(3,4,5),this.camera.lookAt(new a.Vector3),this.focusLight=new i.default(16777215,1.24),this.scene.add(this.focusLight),this.loading=new s.default,this.scene.add(this.loading),window.addEventListener("resize",function(t){return e.onResize(t)},!1)}return e.prototype.onResize=function(e){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)},e.prototype.animate=function(){var e=this;requestAnimationFrame(function(){e.animate()}),this.stats&&this.stats.update(),this.renderer.render(this.scene,this.camera),this.focusLight.update(this.camera)},e.prototype.setStats=function(e){this.stats=e},e.prototype.prevLoad=function(){var e=this;console.log("start load");var t=window.CFG.baseURL,n=new XMLHttpRequest;n.open("GET",t+"/obj/gl/win.bin"),n.onprogress=function(t){if(t.lengthComputable){var n=Math.floor(t.loaded/t.total*100);console.log(n+"%"),e.loading.update(n+"%"),e.scene.add(e.loading)}},n.onreadystatechange=function(){4===n.readyState&&(200===n.status?e.loadObject():alert("加载失败，请刷新页面重新尝试"))},n.send()},e.prototype.loadObject=function(){var e=this,t=new a.LoadingManager(function(){console.log("loaded"),e.scene.remove(e.loading)},function(t,n,a){var r=Math.floor(n/a*100);console.log("load "+r+"%"),e.loading.update(r+"%"),e.scene.add(e.loading)}),n=new o.GLTFLoader(t),r=window.CFG.baseURL;n.setPath(r+"/obj/gl/"),n.load("win.gltf",function(t){console.log("gltf"),console.log(t),t.scene.traverse(function(e){e.isMesh&&(e.name="load_mesh",e.updateMatrix())});var n=t.scene.children[0].children[0].children[0],r=(new a.Box3).setFromObject(n).getSize(new a.Vector3),o=10/Math.max(r.x,r.y,r.z);n.scale.set(o,o,o),n.position.set(0,0,0);var i=new a.Object3D;i.add(n),i.rotateX(Math.PI/2),e.scene.add(i)})},e.prototype.setup=function(){this.addLights(),this.prevLoad(),this.animate()},e.prototype.addLights=function(){var e=new a.AmbientLight(16777215);e.intensity=.4,this.scene.add(e)},e.ZERO=new a.Vector3,e}();t.default=l},function(e,t,n){e.exports=n(9)},function(e,t,n){},function(e,t){e.exports=_dll_three_86da5733},function(e,t,n){"use strict";n.r(t),n.d(t,"OrbitControls",function(){return r}),n.d(t,"MapControls",function(){return o});var a=n(0),r=function(e,t){var n,r,o,i,s;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new a.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:a.MOUSE.ROTATE,MIDDLE:a.MOUSE.DOLLY,RIGHT:a.MOUSE.PAN},this.touches={ONE:a.TOUCH.ROTATE,TWO:a.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(c),l.update(),h=d.NONE},this.update=(n=new a.Vector3,r=(new a.Quaternion).setFromUnitVectors(e.up,new a.Vector3(0,1,0)),o=r.clone().inverse(),i=new a.Vector3,s=new a.Quaternion,function(){var e=l.object.position;return n.copy(e).sub(l.target),n.applyQuaternion(r),f.setFromVector3(n),l.autoRotate&&h===d.NONE&&x(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(f.theta+=v.theta*l.dampingFactor,f.phi+=v.phi*l.dampingFactor):(f.theta+=v.theta,f.phi+=v.phi),f.theta=Math.max(l.minAzimuthAngle,Math.min(l.maxAzimuthAngle,f.theta)),f.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=g,f.radius=Math.max(l.minDistance,Math.min(l.maxDistance,f.radius)),!0===l.enableDamping?l.target.addScaledVector(b,l.dampingFactor):l.target.add(b),n.setFromSpherical(f),n.applyQuaternion(o),e.copy(l.target).add(n),l.object.lookAt(l.target),!0===l.enableDamping?(v.theta*=1-l.dampingFactor,v.phi*=1-l.dampingFactor,b.multiplyScalar(1-l.dampingFactor)):(v.set(0,0,0),b.set(0,0,0)),g=1,!!(y||i.distanceToSquared(l.object.position)>m||8*(1-s.dot(l.object.quaternion))>m)&&(l.dispatchEvent(c),i.copy(l.object.position),s.copy(l.object.quaternion),y=!1,!0)}),this.dispose=function(){l.domElement.removeEventListener("contextmenu",ee,!1),l.domElement.removeEventListener("mousedown",z,!1),l.domElement.removeEventListener("wheel",W,!1),l.domElement.removeEventListener("touchstart",J,!1),l.domElement.removeEventListener("touchend",$,!1),l.domElement.removeEventListener("touchmove",Q,!1),document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",Z,!1),window.removeEventListener("keydown",q,!1)};var l=this,c={type:"change"},u={type:"start"},p={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},h=d.NONE,m=1e-6,f=new a.Spherical,v=new a.Spherical,g=1,b=new a.Vector3,y=!1,T=new a.Vector2,M=new a.Vector2,E=new a.Vector2,S=new a.Vector2,w=new a.Vector2,R=new a.Vector2,L=new a.Vector2,A=new a.Vector2,O=new a.Vector2;function _(){return Math.pow(.95,l.zoomSpeed)}function x(e){v.theta-=e}function P(e){v.phi-=e}var C,U=(C=new a.Vector3,function(e,t){C.setFromMatrixColumn(t,0),C.multiplyScalar(-e),b.add(C)}),N=function(){var e=new a.Vector3;return function(t,n){!0===l.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(l.object.up,e)),e.multiplyScalar(t),b.add(e)}}(),D=function(){var e=new a.Vector3;return function(t,n){var a=l.domElement===document?l.domElement.body:l.domElement;if(l.object.isPerspectiveCamera){var r=l.object.position;e.copy(r).sub(l.target);var o=e.length();o*=Math.tan(l.object.fov/2*Math.PI/180),U(2*t*o/a.clientHeight,l.object.matrix),N(2*n*o/a.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(U(t*(l.object.right-l.object.left)/l.object.zoom/a.clientWidth,l.object.matrix),N(n*(l.object.top-l.object.bottom)/l.object.zoom/a.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();function F(e){l.object.isPerspectiveCamera?g/=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*e)),l.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function H(e){l.object.isPerspectiveCamera?g*=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/e)),l.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function I(e){T.set(e.clientX,e.clientY)}function j(e){S.set(e.clientX,e.clientY)}function G(e){if(1==e.touches.length)T.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);T.set(t,n)}}function k(e){if(1==e.touches.length)S.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);S.set(t,n)}}function B(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+n*n);L.set(0,a)}function V(e){if(1==e.touches.length)M.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);M.set(t,n)}E.subVectors(M,T).multiplyScalar(l.rotateSpeed);var a=l.domElement===document?l.domElement.body:l.domElement;x(2*Math.PI*E.x/a.clientHeight),P(2*Math.PI*E.y/a.clientHeight),T.copy(M)}function K(e){if(1==e.touches.length)w.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(t,n)}R.subVectors(w,S).multiplyScalar(l.panSpeed),D(R.x,R.y),S.copy(w)}function Y(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+n*n);A.set(0,a),O.set(0,Math.pow(A.y/L.y,l.zoomSpeed)),F(O.y),L.copy(A)}function z(e){if(!1!==l.enabled){switch(e.preventDefault(),l.domElement.focus?l.domElement.focus():window.focus(),e.button){case 0:switch(l.mouseButtons.LEFT){case a.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===l.enablePan)return;j(e),h=d.PAN}else{if(!1===l.enableRotate)return;I(e),h=d.ROTATE}break;case a.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===l.enableRotate)return;I(e),h=d.ROTATE}else{if(!1===l.enablePan)return;j(e),h=d.PAN}break;default:h=d.NONE}break;case 1:switch(l.mouseButtons.MIDDLE){case a.MOUSE.DOLLY:if(!1===l.enableZoom)return;!function(e){L.set(e.clientX,e.clientY)}(e),h=d.DOLLY;break;default:h=d.NONE}break;case 2:switch(l.mouseButtons.RIGHT){case a.MOUSE.ROTATE:if(!1===l.enableRotate)return;I(e),h=d.ROTATE;break;case a.MOUSE.PAN:if(!1===l.enablePan)return;j(e),h=d.PAN;break;default:h=d.NONE}}h!==d.NONE&&(document.addEventListener("mousemove",X,!1),document.addEventListener("mouseup",Z,!1),l.dispatchEvent(u))}}function X(e){if(!1!==l.enabled)switch(e.preventDefault(),h){case d.ROTATE:if(!1===l.enableRotate)return;!function(e){M.set(e.clientX,e.clientY),E.subVectors(M,T).multiplyScalar(l.rotateSpeed);var t=l.domElement===document?l.domElement.body:l.domElement;x(2*Math.PI*E.x/t.clientHeight),P(2*Math.PI*E.y/t.clientHeight),T.copy(M),l.update()}(e);break;case d.DOLLY:if(!1===l.enableZoom)return;!function(e){A.set(e.clientX,e.clientY),O.subVectors(A,L),O.y>0?F(_()):O.y<0&&H(_()),L.copy(A),l.update()}(e);break;case d.PAN:if(!1===l.enablePan)return;!function(e){w.set(e.clientX,e.clientY),R.subVectors(w,S).multiplyScalar(l.panSpeed),D(R.x,R.y),S.copy(w),l.update()}(e)}}function Z(e){!1!==l.enabled&&(document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",Z,!1),l.dispatchEvent(p),h=d.NONE)}function W(e){!1===l.enabled||!1===l.enableZoom||h!==d.NONE&&h!==d.ROTATE||(e.preventDefault(),e.stopPropagation(),l.dispatchEvent(u),function(e){e.deltaY<0?H(_()):e.deltaY>0&&F(_()),l.update()}(e),l.dispatchEvent(p))}function q(e){!1!==l.enabled&&!1!==l.enableKeys&&!1!==l.enablePan&&function(e){var t=!1;switch(e.keyCode){case l.keys.UP:D(0,l.keyPanSpeed),t=!0;break;case l.keys.BOTTOM:D(0,-l.keyPanSpeed),t=!0;break;case l.keys.LEFT:D(l.keyPanSpeed,0),t=!0;break;case l.keys.RIGHT:D(-l.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),l.update())}(e)}function J(e){if(!1!==l.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(l.touches.ONE){case a.TOUCH.ROTATE:if(!1===l.enableRotate)return;G(e),h=d.TOUCH_ROTATE;break;case a.TOUCH.PAN:if(!1===l.enablePan)return;k(e),h=d.TOUCH_PAN;break;default:h=d.NONE}break;case 2:switch(l.touches.TWO){case a.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&B(e),l.enablePan&&k(e)}(e),h=d.TOUCH_DOLLY_PAN;break;case a.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&B(e),l.enableRotate&&G(e)}(e),h=d.TOUCH_DOLLY_ROTATE;break;default:h=d.NONE}break;default:h=d.NONE}h!==d.NONE&&l.dispatchEvent(u)}}function Q(e){if(!1!==l.enabled)switch(e.preventDefault(),e.stopPropagation(),h){case d.TOUCH_ROTATE:if(!1===l.enableRotate)return;V(e),l.update();break;case d.TOUCH_PAN:if(!1===l.enablePan)return;K(e),l.update();break;case d.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&Y(e),l.enablePan&&K(e)}(e),l.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&Y(e),l.enableRotate&&V(e)}(e),l.update();break;default:h=d.NONE}}function $(e){!1!==l.enabled&&(l.dispatchEvent(p),h=d.NONE)}function ee(e){!1!==l.enabled&&e.preventDefault()}l.domElement.addEventListener("contextmenu",ee,!1),l.domElement.addEventListener("mousedown",z,!1),l.domElement.addEventListener("wheel",W,!1),l.domElement.addEventListener("touchstart",J,!1),l.domElement.addEventListener("touchend",$,!1),l.domElement.addEventListener("touchmove",Q,!1),window.addEventListener("keydown",q,!1),this.update()};r.prototype=Object.create(a.EventDispatcher.prototype),r.prototype.constructor=r,Object.defineProperties(r.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});var o=function(e,t){r.call(this,e,t),this.mouseButtons.LEFT=a.MOUSE.PAN,this.mouseButtons.RIGHT=a.MOUSE.ROTATE,this.touches.ONE=a.TOUCH.PAN,this.touches.TWO=a.TOUCH.DOLLY_ROTATE};o.prototype=Object.create(a.EventDispatcher.prototype),o.prototype.constructor=o},function(e,t,n){"use strict";n.r(t),n.d(t,"GLTFLoader",function(){return r});var a=n(0),r=function(){function e(e){this.manager=void 0!==e?e:a.DefaultLoadingManager,this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,n,r){var o,i=this;o=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:a.LoaderUtils.extractUrlBase(e),i.manager.itemStart(e);var s=function(t){r?r(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},l=new a.FileLoader(i.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),"use-credentials"===i.crossOrigin&&l.setWithCredentials(!0),l.load(e,function(n){try{i.parse(n,o,function(n){t(n),i.manager.itemEnd(e)},s)}catch(e){s(e)}},n,s)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,l,c){var m,f={};if("string"==typeof e)m=e;else if(a.LoaderUtils.decodeText(new Uint8Array(e,0,4))===s){try{f[n.KHR_BINARY_GLTF]=new u(e)}catch(e){return void(c&&c(e))}m=f[n.KHR_BINARY_GLTF].content}else m=a.LoaderUtils.decodeText(new Uint8Array(e));var v=JSON.parse(m);if(void 0===v.asset||v.asset.version[0]<2)c&&c(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(v.extensionsUsed)for(var g=0;g<v.extensionsUsed.length;++g){var b=v.extensionsUsed[g],y=v.extensionsRequired||[];switch(b){case n.KHR_LIGHTS_PUNCTUAL:f[b]=new o(v);break;case n.KHR_MATERIALS_UNLIT:f[b]=new i;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:f[b]=new h;break;case n.KHR_DRACO_MESH_COMPRESSION:f[b]=new p(v,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:f[n.MSFT_TEXTURE_DDS]=new r(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:f[n.KHR_TEXTURE_TRANSFORM]=new d;break;default:y.indexOf(b)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+b+'".')}}new G(v,f,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(l,c)}}};var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function r(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=e}function o(e){this.name=n.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[n.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function i(){this.name=n.KHR_MATERIALS_UNLIT}o.prototype.loadLight=function(e){var t,n=this.lightDefs[e],r=new a.Color(16777215);void 0!==n.color&&r.fromArray(n.color);var o=void 0!==n.range?n.range:0;switch(n.type){case"directional":(t=new a.DirectionalLight(r)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new a.PointLight(r)).distance=o;break;case"spot":(t=new a.SpotLight(r)).distance=o,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,t.angle=n.spot.outerConeAngle,t.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==n.intensity&&(t.intensity=n.intensity),t.name=n.name||"light_"+e,Promise.resolve(t)},i.prototype.getMaterialType=function(){return a.MeshBasicMaterial},i.prototype.extendParams=function(e,t,n){var r=[];e.color=new a.Color(1,1,1),e.opacity=1;var o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var i=o.baseColorFactor;e.color.fromArray(i),e.opacity=i[3]}void 0!==o.baseColorTexture&&r.push(n.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(r)};var s="glTF",l=12,c={JSON:1313821514,BIN:5130562};function u(e){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,l);if(this.header={magic:a.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==s)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var r=new DataView(e,l),o=0;o<r.byteLength;){var i=r.getUint32(o,!0);o+=4;var u=r.getUint32(o,!0);if(o+=4,u===c.JSON){var p=new Uint8Array(e,l+o,i);this.content=a.LoaderUtils.decodeText(p)}else if(u===c.BIN){var d=l+o;this.body=e.slice(d,d+i)}o+=i}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function p(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function d(){this.name=n.KHR_TEXTURE_TRANSFORM}function h(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return a.ShaderMaterial},extendParams:function(e,t,n){var r=t.extensions[this.name],o=a.ShaderLib.standard,i=a.UniformsUtils.clone(o.uniforms),s=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),l=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),u=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),p=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),d=o.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",s).replace("#include <metalnessmap_pars_fragment>",l).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",u).replace("#include <lights_physical_fragment>",p);delete i.roughness,delete i.metalness,delete i.roughnessMap,delete i.metalnessMap,i.specular={value:(new a.Color).setHex(1118481)},i.glossiness={value:.5},i.specularMap={value:null},i.glossinessMap={value:null},e.vertexShader=o.vertexShader,e.fragmentShader=d,e.uniforms=i,e.defines={STANDARD:""},e.color=new a.Color(1,1,1),e.opacity=1;var h=[];if(Array.isArray(r.diffuseFactor)){var m=r.diffuseFactor;e.color.fromArray(m),e.opacity=m[3]}if(void 0!==r.diffuseTexture&&h.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new a.Color(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new a.Color(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var f=r.specularGlossinessTexture;h.push(n.assignTexture(e,"glossinessMap",f)),h.push(n.assignTexture(e,"specularMap",f))}return Promise.all(h)},createMaterial:function(e){var t=new a.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var n=this.specularGlossinessParams,a=0,r=n.length;a<r;a++){var o=e[n[a]];t[n[a]]=o&&o.isColor?o.clone():o}return t},refreshUniforms:function(e,t,n,a,r){if(!0===r.isGLTFSpecularGlossinessMaterial){var o,i=r.uniforms,s=r.defines;i.opacity.value=r.opacity,i.diffuse.value.copy(r.color),i.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),i.map.value=r.map,i.specularMap.value=r.specularMap,i.alphaMap.value=r.alphaMap,i.lightMap.value=r.lightMap,i.lightMapIntensity.value=r.lightMapIntensity,i.aoMap.value=r.aoMap,i.aoMapIntensity.value=r.aoMapIntensity,r.map?o=r.map:r.specularMap?o=r.specularMap:r.displacementMap?o=r.displacementMap:r.normalMap?o=r.normalMap:r.bumpMap?o=r.bumpMap:r.glossinessMap?o=r.glossinessMap:r.alphaMap?o=r.alphaMap:r.emissiveMap&&(o=r.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),i.uvTransform.value.copy(o.matrix)),r.envMap&&(i.envMap.value=r.envMap,i.envMapIntensity.value=r.envMapIntensity,i.flipEnvMap.value=r.envMap.isCubeTexture?-1:1,i.reflectivity.value=r.reflectivity,i.refractionRatio.value=r.refractionRatio,i.maxMipLevel.value=e.properties.get(r.envMap).__maxMipLevel),i.specular.value.copy(r.specular),i.glossiness.value=r.glossiness,i.glossinessMap.value=r.glossinessMap,i.emissiveMap.value=r.emissiveMap,i.bumpMap.value=r.bumpMap,i.normalMap.value=r.normalMap,i.displacementMap.value=r.displacementMap,i.displacementScale.value=r.displacementScale,i.displacementBias.value=r.displacementBias,null!==i.glossinessMap.value&&void 0===s.USE_GLOSSINESSMAP&&(s.USE_GLOSSINESSMAP="",s.USE_ROUGHNESSMAP=""),null===i.glossinessMap.value&&void 0!==s.USE_GLOSSINESSMAP&&(delete s.USE_GLOSSINESSMAP,delete s.USE_ROUGHNESSMAP)}}}}function m(e,t,n,r){a.Interpolant.call(this,e,t,n,r)}p.prototype.decodePrimitive=function(e,t){var n=this.json,a=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,i={},s={},l={};for(var c in o){var u=A[c]||c.toLowerCase();i[u]=o[c]}for(c in e.attributes){u=A[c]||c.toLowerCase();if(void 0!==o[c]){var p=n.accessors[e.attributes[c]],d=S[p.componentType];l[u]=d,s[u]=!0===p.normalized}}return t.getDependency("bufferView",r).then(function(e){return new Promise(function(t){a.decodeDracoFile(e,function(e){for(var n in e.attributes){var a=e.attributes[n],r=s[n];void 0!==r&&(a.normalized=r)}t(e)},i,l)})})},d.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},m.prototype=Object.create(a.Interpolant.prototype),m.prototype.constructor=m,m.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,a=this.valueSize,r=e*a*3+a,o=0;o!==a;o++)t[o]=n[r+o];return t},m.prototype.beforeStart_=m.prototype.copySampleValue_,m.prototype.afterEnd_=m.prototype.copySampleValue_,m.prototype.interpolate_=function(e,t,n,a){for(var r=this.resultBuffer,o=this.sampleValues,i=this.valueSize,s=2*i,l=3*i,c=a-t,u=(n-t)/c,p=u*u,d=p*u,h=e*l,m=h-l,f=-2*d+3*p,v=d-p,g=1-f,b=v-p+u,y=0;y!==i;y++){var T=o[m+y+i],M=o[m+y+s]*c,E=o[h+y+i],S=o[h+y]*c;r[y]=g*T+b*M+f*E+v*S}return r};var f,v=0,g=1,b=2,y=3,T=4,M=5,E=6,S={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},w={9728:a.NearestFilter,9729:a.LinearFilter,9984:a.NearestMipmapNearestFilter,9985:a.LinearMipmapNearestFilter,9986:a.NearestMipmapLinearFilter,9987:a.LinearMipmapLinearFilter},R={33071:a.ClampToEdgeWrapping,33648:a.MirroredRepeatWrapping,10497:a.RepeatWrapping},L={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},A={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},O={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},_={CUBICSPLINE:void 0,LINEAR:a.InterpolateLinear,STEP:a.InterpolateDiscrete},x="OPAQUE",P="MASK",C="BLEND",U={"image/png":a.RGBAFormat,"image/jpeg":a.RGBFormat};function N(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)}function D(e,t,n){for(var a in n.extensions)void 0===e[a]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[a]=n.extensions[a])}function F(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function H(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,a=t.weights.length;n<a;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(n=0,a=r.length;n<a;n++)e.morphTargetDictionary[r[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function I(e){for(var t="",n=Object.keys(e).sort(),a=0,r=n.length;a<r;a++)t+=n[a]+":"+e[n[a]]+";";return t}function j(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,n=e.itemSize,r=e.array.slice(0,t*n),o=0,i=0;o<t;++o)r[i++]=e.getX(o),n>=2&&(r[i++]=e.getY(o)),n>=3&&(r[i++]=e.getZ(o)),n>=4&&(r[i++]=e.getW(o));return new a.BufferAttribute(r,n,e.normalized)}return e.clone()}function G(e,n,r){this.json=e||{},this.extensions=n||{},this.options=r||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new a.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new a.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function k(e,t,n){var a=t.attributes,r=[];function o(t,a){return n.getDependency("accessor",t).then(function(t){e.addAttribute(a,t)})}for(var i in a){var s=A[i]||i.toLowerCase();s in e.attributes||r.push(o(a[i],s))}if(void 0!==t.indices&&!e.index){var l=n.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});r.push(l)}return F(e,t),Promise.all(r).then(function(){return void 0!==t.targets?function(e,t,n){for(var a=!1,r=!1,o=0,i=t.length;o<i;o++){if(void 0!==(c=t[o]).POSITION&&(a=!0),void 0!==c.NORMAL&&(r=!0),a&&r)break}if(!a&&!r)return Promise.resolve(e);var s=[],l=[];for(o=0,i=t.length;o<i;o++){var c=t[o];if(a){var u=void 0!==c.POSITION?n.getDependency("accessor",c.POSITION):e.attributes.position;s.push(u)}if(r){u=void 0!==c.NORMAL?n.getDependency("accessor",c.NORMAL):e.attributes.normal;l.push(u)}}return Promise.all([Promise.all(s),Promise.all(l)]).then(function(n){for(var o=n[0],i=n[1],s=0,l=o.length;s<l;s++)e.attributes.position!==o[s]&&(o[s]=j(o[s]));for(s=0,l=i.length;s<l;s++)e.attributes.normal!==i[s]&&(i[s]=j(i[s]));for(s=0,l=t.length;s<l;s++){var c=t[s],u="morphTarget"+s;if(a&&void 0!==c.POSITION){var p=o[s];p.name=u;for(var d=e.attributes.position,h=0,m=p.count;h<m;h++)p.setXYZ(h,p.getX(h)+d.getX(h),p.getY(h)+d.getY(h),p.getZ(h)+d.getZ(h))}if(r&&void 0!==c.NORMAL){var f=i[s];f.name=u;var v=e.attributes.normal;for(h=0,m=f.count;h<m;h++)f.setXYZ(h,f.getX(h)+v.getX(h),f.getY(h)+v.getY(h),f.getZ(h)+v.getZ(h))}}return a&&(e.morphAttributes.position=o),r&&(e.morphAttributes.normal=i),e})}(e,t.targets,n):e})}return G.prototype.parse=function(e,t){var n=this,a=this.json,r=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(t){var o={scene:t[0][a.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:a.asset,parser:n,userData:{}};D(r,o,a),F(o,a),e(o)}).catch(t)},G.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],a={},r={},o=0,i=t.length;o<i;o++)for(var s=t[o].joints,l=0,c=s.length;l<c;l++)e[s[l]].isBone=!0;for(var u=0,p=e.length;u<p;u++){var d=e[u];void 0!==d.mesh&&(void 0===a[d.mesh]&&(a[d.mesh]=r[d.mesh]=0),a[d.mesh]++,void 0!==d.skin&&(n[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=a,this.json.meshUses=r},G.prototype.getDependency=function(e,t){var a=e+":"+t,r=this.cache.get(a);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this.loadMesh(t);break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this.loadBufferView(t);break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this.loadMaterial(t);break;case"texture":r=this.loadTexture(t);break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;case"light":r=this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(a,r)}return r},G.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,a=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(a.map(function(t,a){return n.getDependency(e,a)})),this.cache.add(e,t)}return t},G.prototype.loadBuffer=function(e){var t=this.json.buffers[e],a=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var r=this.options;return new Promise(function(e,n){a.load(N(t.uri,r.path),e,void 0,function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},G.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var n=t.byteLength||0,a=t.byteOffset||0;return e.slice(a,a+n)})},G.prototype.loadAccessor=function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var o=[];return void 0!==r.bufferView?o.push(this.getDependency("bufferView",r.bufferView)):o.push(null),void 0!==r.sparse&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then(function(e){var o,i,s=e[0],l=L[r.type],c=S[r.componentType],u=c.BYTES_PER_ELEMENT,p=u*l,d=r.byteOffset||0,h=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,m=!0===r.normalized;if(h&&h!==p){var f=Math.floor(d/h),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+f+":"+r.count,g=t.cache.get(v);g||(o=new c(s,f*h,r.count*h/u),g=new a.InterleavedBuffer(o,h/u),t.cache.add(v,g)),i=new a.InterleavedBufferAttribute(g,l,d%h/u,m)}else o=null===s?new c(r.count*l):new c(s,d,r.count*l),i=new a.BufferAttribute(o,l,m);if(void 0!==r.sparse){var b=L.SCALAR,y=S[r.sparse.indices.componentType],T=r.sparse.indices.byteOffset||0,M=r.sparse.values.byteOffset||0,E=new y(e[1],T,r.sparse.count*b),w=new c(e[2],M,r.sparse.count*l);null!==s&&i.setArray(i.array.slice());for(var R=0,A=E.length;R<A;R++){var O=E[R];if(i.setX(O,w[R*l]),l>=2&&i.setY(O,w[R*l+1]),l>=3&&i.setZ(O,w[R*l+2]),l>=4&&i.setW(O,w[R*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i})},G.prototype.loadTexture=function(e){var t,r=this,o=this.json,i=this.options,s=this.textureLoader,l=window.URL||window.webkitURL,c=o.textures[e],u=c.extensions||{},p=(t=u[n.MSFT_TEXTURE_DDS]?o.images[u[n.MSFT_TEXTURE_DDS].source]:o.images[c.source]).uri,d=!1;return void 0!==t.bufferView&&(p=r.getDependency("bufferView",t.bufferView).then(function(e){d=!0;var n=new Blob([e],{type:t.mimeType});return p=l.createObjectURL(n)})),Promise.resolve(p).then(function(e){var t=a.Loader.Handlers.get(e);return t||(t=u[n.MSFT_TEXTURE_DDS]?r.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:s),new Promise(function(n,a){t.load(N(e,i.path),n,void 0,a)})}).then(function(e){!0===d&&l.revokeObjectURL(p),e.flipY=!1,void 0!==c.name&&(e.name=c.name),t.mimeType in U&&(e.format=U[t.mimeType]);var n=(o.samplers||{})[c.sampler]||{};return e.magFilter=w[n.magFilter]||a.LinearFilter,e.minFilter=w[n.minFilter]||a.LinearMipmapLinearFilter,e.wrapS=R[n.wrapS]||a.RepeatWrapping,e.wrapT=R[n.wrapT]||a.RepeatWrapping,e})},G.prototype.assignTexture=function(e,t,r){var o=this;return this.getDependency("texture",r.index).then(function(i){if(!i.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":i.format=a.RGBFormat}if(o.extensions[n.KHR_TEXTURE_TRANSFORM]){var s=void 0!==r.extensions?r.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;s&&(i=o.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(i,s))}e[t]=i})},G.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,o=this.extensions,i=void 0!==t.attributes.tangent,s=void 0!==t.attributes.color,l=void 0===t.attributes.normal,c=!0===e.isSkinnedMesh,u=Object.keys(t.morphAttributes).length>0,p=u&&void 0!==t.morphAttributes.normal;if(e.isPoints){var d="PointsMaterial:"+r.uuid,h=this.cache.get(d);h||(h=new a.PointsMaterial,a.Material.prototype.copy.call(h,r),h.color.copy(r.color),h.map=r.map,h.lights=!1,this.cache.add(d,h)),r=h}else if(e.isLine){d="LineBasicMaterial:"+r.uuid;var m=this.cache.get(d);m||(m=new a.LineBasicMaterial,a.Material.prototype.copy.call(m,r),m.color.copy(r.color),m.lights=!1,this.cache.add(d,m)),r=m}if(i||s||l||c||u){d="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(d+="specular-glossiness:"),c&&(d+="skinning:"),i&&(d+="vertex-tangents:"),s&&(d+="vertex-colors:"),l&&(d+="flat-shading:"),u&&(d+="morph-targets:"),p&&(d+="morph-normals:");var f=this.cache.get(d);f||(f=r.isGLTFSpecularGlossinessMaterial?o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(r):r.clone(),c&&(f.skinning=!0),i&&(f.vertexTangents=!0),s&&(f.vertexColors=a.VertexColors),l&&(f.flatShading=!0),u&&(f.morphTargets=!0),p&&(f.morphNormals=!0),this.cache.add(d,f)),r=f}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),t.addAttribute("uv2",new a.BufferAttribute(t.attributes.uv.array,2))),r.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=r},G.prototype.loadMaterial=function(e){var t,r=this.json,o=this.extensions,i=r.materials[e],s={},l=i.extensions||{},c=[];if(l[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=u.getMaterialType(),c.push(u.extendParams(s,i,this))}else if(l[n.KHR_MATERIALS_UNLIT]){var p=o[n.KHR_MATERIALS_UNLIT];t=p.getMaterialType(),c.push(p.extendParams(s,i,this))}else{t=a.MeshStandardMaterial;var d=i.pbrMetallicRoughness||{};if(s.color=new a.Color(1,1,1),s.opacity=1,Array.isArray(d.baseColorFactor)){var h=d.baseColorFactor;s.color.fromArray(h),s.opacity=h[3]}void 0!==d.baseColorTexture&&c.push(this.assignTexture(s,"map",d.baseColorTexture)),s.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,s.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(this.assignTexture(s,"metalnessMap",d.metallicRoughnessTexture)),c.push(this.assignTexture(s,"roughnessMap",d.metallicRoughnessTexture)))}!0===i.doubleSided&&(s.side=a.DoubleSide);var m=i.alphaMode||x;return m===C?s.transparent=!0:(s.transparent=!1,m===P&&(s.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&t!==a.MeshBasicMaterial&&(c.push(this.assignTexture(s,"normalMap",i.normalTexture)),s.normalScale=new a.Vector2(1,1),void 0!==i.normalTexture.scale&&s.normalScale.set(i.normalTexture.scale,i.normalTexture.scale)),void 0!==i.occlusionTexture&&t!==a.MeshBasicMaterial&&(c.push(this.assignTexture(s,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(s.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&t!==a.MeshBasicMaterial&&(s.emissive=(new a.Color).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&t!==a.MeshBasicMaterial&&c.push(this.assignTexture(s,"emissiveMap",i.emissiveTexture)),Promise.all(c).then(function(){var e;return e=t===a.ShaderMaterial?o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),void 0!==i.name&&(e.name=i.name),e.map&&(e.map.encoding=a.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=a.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=a.sRGBEncoding),F(e,i),i.extensions&&D(o,e,i),e})},G.prototype.loadGeometries=function(e){var t=this,r=this.extensions,o=this.primitiveCache;function i(e){return r[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(n){return k(n,e,t)})}for(var s,l,c=[],u=0,p=e.length;u<p;u++){var d,h=e[u],m=(l=void 0,(l=(s=h).extensions&&s.extensions[n.KHR_DRACO_MESH_COMPRESSION])?"draco:"+l.bufferView+":"+l.indices+":"+I(l.attributes):s.indices+":"+I(s.attributes)+":"+s.mode),f=o[m];if(f)c.push(f.promise);else d=h.extensions&&h.extensions[n.KHR_DRACO_MESH_COMPRESSION]?i(h):k(new a.BufferGeometry,h,t),o[m]={primitive:h,promise:d},c.push(d)}return Promise.all(c)},G.prototype.loadMesh=function(e){for(var t=this,n=this.json.meshes[e],r=n.primitives,o=[],i=0,s=r.length;i<s;i++){var l=void 0===r[i].material?f=f||new a.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:a.FrontSide}):this.getDependency("material",r[i].material);o.push(l)}return Promise.all(o).then(function(o){return t.loadGeometries(r).then(function(i){for(var s=[],l=0,c=i.length;l<c;l++){var u,p=i[l],d=r[l],h=o[l];if(d.mode===T||d.mode===M||d.mode===E||void 0===d.mode)!0!==(u=!0===n.isSkinnedMesh?new a.SkinnedMesh(p,h):new a.Mesh(p,h)).isSkinnedMesh||u.geometry.attributes.skinWeight.normalized||u.normalizeSkinWeights(),d.mode===M?u.drawMode=a.TriangleStripDrawMode:d.mode===E&&(u.drawMode=a.TriangleFanDrawMode);else if(d.mode===g)u=new a.LineSegments(p,h);else if(d.mode===y)u=new a.Line(p,h);else if(d.mode===b)u=new a.LineLoop(p,h);else{if(d.mode!==v)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);u=new a.Points(p,h)}Object.keys(u.geometry.morphAttributes).length>0&&H(u,n),u.name=n.name||"mesh_"+e,i.length>1&&(u.name+="_"+l),F(u,n),t.assignFinalMaterial(u),s.push(u)}if(1===s.length)return s[0];var m=new a.Group;for(l=0,c=s.length;l<c;l++)m.add(s[l]);return m})})},G.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new a.PerspectiveCamera(a.Math.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new a.OrthographicCamera(r.xmag/-2,r.xmag/2,r.ymag/2,r.ymag/-2,r.znear,r.zfar)),void 0!==n.name&&(t.name=n.name),F(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},G.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return n.inverseBindMatrices=e,n})},G.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],n=[],r=[],o=[],i=[],s=[],l=0,c=t.channels.length;l<c;l++){var u=t.channels[l],p=t.samplers[u.sampler],d=u.target,h=void 0!==d.node?d.node:d.id,f=void 0!==t.parameters?t.parameters[p.input]:p.input,v=void 0!==t.parameters?t.parameters[p.output]:p.output;n.push(this.getDependency("node",h)),r.push(this.getDependency("accessor",f)),o.push(this.getDependency("accessor",v)),i.push(p),s.push(d)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(o),Promise.all(i),Promise.all(s)]).then(function(n){for(var r=n[0],o=n[1],i=n[2],s=n[3],l=n[4],c=[],u=0,p=r.length;u<p;u++){var d=r[u],h=o[u],f=i[u],v=s[u],g=l[u];if(void 0!==d){var b;switch(d.updateMatrix(),d.matrixAutoUpdate=!0,O[g.path]){case O.weights:b=a.NumberKeyframeTrack;break;case O.rotation:b=a.QuaternionKeyframeTrack;break;case O.position:case O.scale:default:b=a.VectorKeyframeTrack}var y=d.name?d.name:d.uuid,T=void 0!==v.interpolation?_[v.interpolation]:a.InterpolateLinear,M=[];O[g.path]===O.weights?d.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&M.push(e.name?e.name:e.uuid)}):M.push(y);var E=f.array;if(f.normalized){var S;if(E.constructor===Int8Array)S=1/127;else if(E.constructor===Uint8Array)S=1/255;else if(E.constructor==Int16Array)S=1/32767;else{if(E.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");S=1/65535}for(var w=new Float32Array(E.length),R=0,L=E.length;R<L;R++)w[R]=E[R]*S;E=w}for(R=0,L=M.length;R<L;R++){var A=new b(M[R]+"."+O[g.path],h.array,E,T);"CUBICSPLINE"===v.interpolation&&(A.createInterpolant=function(e){return new m(this.times,this.values,this.getValueSize()/3,e)},A.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(A)}}}var x=void 0!==t.name?t.name:"animation_"+e;return new a.AnimationClip(x,void 0,c)})},G.prototype.loadNode=function(e){var t,r=this.json,o=this.extensions,i=this,s=r.meshReferences,l=r.meshUses,c=r.nodes[e];return(t=[],void 0!==c.mesh&&t.push(i.getDependency("mesh",c.mesh).then(function(e){var t;if(s[c.mesh]>1){var n=l[c.mesh]++;(t=e.clone()).name+="_instance_"+n,t.onBeforeRender=e.onBeforeRender;for(var a=0,r=t.children.length;a<r;a++)t.children[a].name+="_instance_"+n,t.children[a].onBeforeRender=e.children[a].onBeforeRender}else t=e;return void 0!==c.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,n=c.weights.length;t<n;t++)e.morphTargetInfluences[t]=c.weights[t]}),t})),void 0!==c.camera&&t.push(i.getDependency("camera",c.camera)),c.extensions&&c.extensions[n.KHR_LIGHTS_PUNCTUAL]&&void 0!==c.extensions[n.KHR_LIGHTS_PUNCTUAL].light&&t.push(i.getDependency("light",c.extensions[n.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then(function(e){var t;if((t=!0===c.isBone?new a.Bone:e.length>1?new a.Group:1===e.length?e[0]:new a.Object3D)!==e[0])for(var n=0,r=e.length;n<r;n++)t.add(e[n]);if(void 0!==c.name&&(t.userData.name=c.name,t.name=a.PropertyBinding.sanitizeNodeName(c.name)),F(t,c),c.extensions&&D(o,t,c),void 0!==c.matrix){var i=new a.Matrix4;i.fromArray(c.matrix),t.applyMatrix(i)}else void 0!==c.translation&&t.position.fromArray(c.translation),void 0!==c.rotation&&t.quaternion.fromArray(c.rotation),void 0!==c.scale&&t.scale.fromArray(c.scale);return t})},G.prototype.loadScene=function(){function e(t,n,r,o){var i=r.nodes[t];return o.getDependency("node",t).then(function(e){return void 0===i.skin?e:o.getDependency("skin",i.skin).then(function(e){for(var n=[],a=0,r=(t=e).joints.length;a<r;a++)n.push(o.getDependency("node",t.joints[a]));return Promise.all(n)}).then(function(n){return e.traverse(function(e){if(e.isMesh){for(var r=[],o=[],i=0,s=n.length;i<s;i++){var l=n[i];if(l){r.push(l);var c=new a.Matrix4;void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*i),o.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[i])}e.bind(new a.Skeleton(r,o),e.matrixWorld)}}),e});var t}).then(function(t){n.add(t);var a=[];if(i.children)for(var s=i.children,l=0,c=s.length;l<c;l++){var u=s[l];a.push(e(u,t,r,o))}return Promise.all(a)})}return function(t){var n=this.json,r=this.extensions,o=this.json.scenes[t],i=new a.Scene;void 0!==o.name&&(i.name=o.name),F(i,o),o.extensions&&D(r,i,o);for(var s=o.nodes||[],l=[],c=0,u=s.length;c<u;c++)l.push(e(s[c],i,n,this));return Promise.all(l).then(function(){return i})}}(),e}()},function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,a,r){var o=e.call(this,t,n,a,r)||this;return o.castShadow=!0,o}return r(t,e),t.prototype.update=function(e){this.position.copy(e.position),this.rotation.copy(e.rotation)},t}(n(0).PointLight);t.default=o},function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=function(e){function t(){var t=e.call(this)||this;return t.w=512,t.h=512,t.init(),t}return r(t,e),t.prototype.init=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.w,this.canvas.height=this.h,this.spriteMap=new o.CanvasTexture(this.canvas),this.spriteMaterial=new o.SpriteMaterial({map:this.spriteMap,transparent:!0,sizeAttenuation:!0});var e=new o.Sprite(this.spriteMaterial);this.add(e)},t.prototype.update=function(e){var t=this.canvas.getContext("2d");t.fillStyle="#409EFF",t.arc(this.w/2,this.h/2,this.w/2,0,2*Math.PI),t.fill(),t.font="180px bold",t.fillStyle="#ffffff",t.textAlign="center",t.textBaseline="middle",t.fillText(e,this.w/2,this.h/2),this.spriteMap.needsUpdate=!0,this.spriteMaterial.needsUpdate=!0},t}(o.Object3D);t.default=i},function(e,t,n){"use strict";n.r(t);n(3);var a=n(1),r=n.n(a),o=function(){var e=0,t=document.createElement("div");function n(e){return t.appendChild(e.dom),e}function a(n){for(var a=0;a<t.children.length;a++)t.children[a].style.display=a===n?"block":"none";e=n}t.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",t.addEventListener("click",function(n){n.preventDefault(),a(++e%t.children.length)},!1);var r=(performance||Date).now(),i=r,s=0,l=n(new o.Panel("FPS","#0ff","#002")),c=n(new o.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=n(new o.Panel("MB","#f08","#201"));return a(0),{REVISION:16,dom:t,addPanel:n,showPanel:a,begin:function(){r=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(c.update(e-r,200),e>=i+1e3&&(l.update(1e3*s/(e-i),100),i=e,s=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){r=this.end()},domElement:t,setMode:a}};o.Panel=function(e,t,n){var a=1/0,r=0,o=Math.round,i=o(window.devicePixelRatio||1),s=80*i,l=48*i,c=3*i,u=2*i,p=3*i,d=15*i,h=74*i,m=30*i,f=document.createElement("canvas");f.width=s,f.height=l,f.style.cssText="width:80px;height:48px";var v=f.getContext("2d");return v.font="bold "+9*i+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=n,v.fillRect(0,0,s,l),v.fillStyle=t,v.fillText(e,c,u),v.fillRect(p,d,h,m),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(p,d,h,m),{dom:f,update:function(l,g){a=Math.min(a,l),r=Math.max(r,l),v.fillStyle=n,v.globalAlpha=1,v.fillRect(0,0,s,d),v.fillStyle=t,v.fillText(o(l)+" "+e+" ("+o(a)+"-"+o(r)+")",c,u),v.drawImage(f,p+i,d,h-i,m,p,d,h-i,m),v.fillRect(p+h-i,d,i,m),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(p+h-i,d,i,o((1-l/g)*m))}}};var i=o;let s=new r.a;var l;s.setup(),(l=new i).setMode(0),l.domElement.style.position="absolute",l.domElement.style.left="0px",l.domElement.style.top="0px",document.body.appendChild(l.domElement),s.setStats(l)}]);
//# sourceMappingURL=win.js.map