(function(e){function t(t){for(var n,s,o=t[0],l=t[1],c=t[2],u=0,h=[];u<o.length;u++)s=o[u],i[s]&&h.push(i[s][0]),i[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);m&&m(t);while(h.length)h.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,s=1;s<a.length;s++){var l=a[s];0!==i[l]&&(n=!1)}n&&(r.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},i={app:0},r=[];function s(e){return o.p+"js/"+({about:"about"}[e]||e)+"."+{about:"08b596a3"}[e]+".js"}function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(e){var t=[],a=i[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise(function(t,n){a=i[e]=[t,n]});t.push(a[2]=n);var r,l=document.createElement("script");l.charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.src=s(e),r=function(t){l.onerror=l.onload=null,clearTimeout(c);var a=i[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src,s=new Error("Loading chunk "+e+" failed.\n("+n+": "+r+")");s.type=n,s.request=r,a[1](s)}i[e]=void 0}};var c=setTimeout(function(){r({type:"timeout",target:l})},12e4);l.onerror=l.onload=r,document.head.appendChild(l)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var m=c;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"034f":function(e,t,a){"use strict";var n=a("64a9"),i=a.n(n);i.a},"0432":function(e,t,a){"use strict";var n=a("aba9"),i=a.n(n);i.a},"08e4":function(e,t,a){"use strict";var n=a("fe0d"),i=a.n(n);i.a},"178c":function(e,t,a){},"1fd7":function(e,t,a){},2250:function(e,t,a){},"225b":function(e,t,a){"use strict";var n=a("d318"),i=a.n(n);i.a},"277d":function(e,t,a){"use strict";var n=a("c31d"),i=a.n(n);i.a},3182:function(e,t,a){"use strict";var n=a("9ea2"),i=a.n(n);i.a},"31ad":function(e,t,a){"use strict";var n=a("6332"),i=a.n(n);i.a},3356:function(e,t,a){},"399a":function(e,t,a){"use strict";var n=a("2250"),i=a.n(n);i.a},4918:function(e,t,a){},"493d":function(e,t){e.exports=_dll_three_114e2f07},5553:function(e,t,a){"use strict";var n=a("1fd7"),i=a.n(n);i.a},"5a89":function(e,t,a){e.exports=a("493d")(1)},"5f0c":function(e,t,a){"use strict";var n=a("9b0c"),i=a.n(n);i.a},6332:function(e,t,a){},"64a9":function(e,t,a){},"719e":function(e,t,a){},7955:function(e,t,a){},"7afc":function(e,t,a){},"7d3a":function(e,t,a){},"8a01":function(e,t,a){"use strict";var n=a("178c"),i=a.n(n);i.a},"9b0c":function(e,t,a){},"9ea2":function(e,t,a){},aa34:function(e,t,a){"use strict";var n=a("7955"),i=a.n(n);i.a},aba9:function(e,t,a){},ac60:function(e,t,a){"use strict";var n=a("7d3a"),i=a.n(n);i.a},b8bc:function(e,t,a){},c31d:function(e,t,a){},c4a6:function(e,t,a){"use strict";var n=a("719e"),i=a.n(n);i.a},cd49:function(t,a,n){"use strict";n.r(a);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},s=[],o=(n("034f"),n("2877")),l={},c=Object(o["a"])(l,r,s,!1,null,null,null),u=c.exports,m=n("8c4f"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("Stage"),a("LeftSide"),a("RightSide"),a("TextureView"),a("CustomGeometry")],1)},d=[],f=n("d225"),p=n("308d"),v=n("6bb5"),g=n("4e2b"),b=n("9ab4"),y=n("60a3"),w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"hello"},[a("h1",[e._v(e._s(e.msg))]),e._m(0),a("h3",[e._v("Installed CLI Plugins")]),e._m(1),a("h3",[e._v("Essential Links")]),e._m(2),a("h3",[e._v("Ecosystem")]),e._m(3)])},C=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[e._v("\n    For a guide and recipes on how to configure / customize this project,"),a("br"),e._v("\n    check out the\n    "),a("a",{attrs:{href:"https://cli.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-cli documentation")]),e._v(".\n  ")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel",target:"_blank",rel:"noopener"}},[e._v("babel")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-typescript",target:"_blank",rel:"noopener"}},[e._v("typescript")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint",target:"_blank",rel:"noopener"}},[e._v("eslint")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-unit-mocha",target:"_blank",rel:"noopener"}},[e._v("unit-mocha")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",[a("li",[a("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Core Docs")])]),a("li",[a("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Forum")])]),a("li",[a("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Community Chat")])]),a("li",[a("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank",rel:"noopener"}},[e._v("Twitter")])]),a("li",[a("a",{attrs:{href:"https://news.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("News")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",[a("li",[a("a",{attrs:{href:"https://router.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-router")])]),a("li",[a("a",{attrs:{href:"https://vuex.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vuex")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-devtools#vue-devtools",target:"_blank",rel:"noopener"}},[e._v("vue-devtools")])]),a("li",[a("a",{attrs:{href:"https://vue-loader.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-loader")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank",rel:"noopener"}},[e._v("awesome-vue")])])])}],_=function(e){function t(){return Object(f["a"])(this,t),Object(p["a"])(this,Object(v["a"])(t).apply(this,arguments))}return Object(g["a"])(t,e),t}(y["d"]);b["a"]([Object(y["b"])()],_.prototype,"msg",void 0),_=b["a"]([y["a"]],_);var M=_,T=M,k=(n("cfae"),Object(o["a"])(T,w,C,!1,null,"341b83d0",null)),x=k.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"stage"},[a("div",{staticClass:"btns"},[a("input",{ref:"file",staticClass:"file",attrs:{type:"file"},on:{change:e.handleFile}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-sold-out"},on:{click:e.handleLoad}},[e._v("加载模型")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-position"},on:{click:e.handleSave}},[e._v("导出模型")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-position"},on:{click:e.handleTest}},[e._v("测试")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-position"},on:{click:e.handleCustomGeometry}},[e._v("自定义模型")])],1),a("p",{staticClass:"info"},[e._v("Q-坐标系 | W-移动 | E-旋转 | R-缩放 | G-参考线")]),a("canvas",{ref:"canvas",staticClass:"canvas"})])},E=[],O=(n("c5f6"),n("7f7f"),n("28a5"),n("b0b4")),j=n("75fc"),L=(n("ac6a"),n("673e"),n("14b9"),n("4917"),n("5a89")),S=n("4721"),V=n("b1f1"),$=n("34ad"),G=function(){function e(){Object(f["a"])(this,e),this.version="v"+Math.random(),console.log(this.version)}return Object(O["a"])(e,[{key:"init",value:function(e){this._sender=e}},{key:"on",value:function(e,t){this._sender.addEventListener(e,t)}},{key:"send",value:function(e,t){this._sender.dispatchEvent(new CustomEvent(e,{detail:t}))}}],[{key:"ins",get:function(){return this._ins||(this._ins=new e),this._ins}}]),e}();G.SELECT_ITEM="select item",G.ITEM_INFO="item info",G.DELETE_ITEM="delete item",G.COPY_ITEM="copy item",G.CUSTOM_GEOMETRY="custom geometry",G.DELETE_TEXTURE="delete texture",G.ADD_LIGHT="add light",G.SELECT_LIGHT="select light",G.CHANGE_PARAM="change param",G.CHANGE_TRANSFORM="change transform",G.CHANGE_MATERIAL="change material",G.CHANGE_ITEM_PARAM="change item param";var P=n("9e5c");function B(e){function t(e){var t=!1,a=new P["a"];a.parse(e,function(e){if(console.log(e),e instanceof ArrayBuffer)i(e,"scene.glb");else{var t=JSON.stringify(e,null,2);n(t,"scene.gltf")}},{binary:!1,embedImages:t,forcePowerOfTwoTextures:t,truncateDrawRange:!1})}function a(e,t){var a=document.createElement("a");a.style.display="none",document.body.appendChild(a),a.href=URL.createObjectURL(e),a.download=t,a.click()}function n(e,t){a(new Blob([e],{type:"text/plain"}),t)}function i(e,t){a(new Blob([e],{type:"application/octet-stream"}),t)}console.log("GLTFTooler"),console.log(e),t(e)}var N=B,A=(n("7514"),[{name:"MeshBasicMaterial",type:"MeshBasicMaterial",param:{color:"#ff0000",map:null,wireframe:!1,opacity:.1,transparent:!0,side:null,visible:!0}},{name:"MeshNormalMaterial",type:"MeshNormalMaterial",param:{color:"#ff0000",map:null,wireframe:!1,opacity:.1,transparent:!0,side:null,visible:!0}},{name:"MeshLambertMaterial",type:"MeshLambertMaterial",param:{color:"#ff0000",map:null,wireframe:!1,opacity:.1,transparent:!0,side:null,visible:!0,emissive:"#ffffff",emissiveIntensity:.1,reflectivity:.1,refractionRatio:.1}},{name:"MeshPhongMaterial",type:"MeshPhongMaterial",param:{color:"#ff0000",map:null,wireframe:!1,opacity:.1,transparent:!0,side:null,visible:!0,emissive:"#ffffff",emissiveIntensity:.1,reflectivity:.1,refractionRatio:.1,specular:"#ffffff",shininess:.1,bumpMap:null,bumpScale:.1,normalMap:null,normalScale:.1,displacementMap:null,displacementScale:.1}},{name:"MeshToonMaterial",type:"MeshToonMaterial",param:{color:"#ff0000",map:null,wireframe:!1,opacity:.1,transparent:!0,side:null,visible:!0}},{name:"MeshStandardMaterial",type:"MeshStandardMaterial",param:{color:"#ff0000",map:null,wireframe:!1,opacity:.1,transparent:!0,side:null,visible:!0,roughness:.1,metalness:.1,bumpMap:null,bumpScale:.1,normalMap:null,normalScale:.1,displacementMap:null,displacementScale:.1}}]),D=function(){function e(){Object(f["a"])(this,e)}return Object(O["a"])(e,null,[{key:"getType",value:function(e){var t;return e=e.split(".")[0],t="wireframe"==e||"transparent"==e||"visible"==e||"helpVisible"==e?this.TYPE_SWITCH:this.checkMap(e)?this.TYPE_IMAGE:"color"==e||"emissive"==e||"specular"==e||"skyColor"==e||"groundColor"==e?this.TYPE_COLOR:this.TYPE_NUMBER,t}},{key:"checkMap",value:function(e){return"map"==e.substr(-3).toLowerCase()}},{key:"setObjectValue",value:function(e,t,a){var n=t.split(".");if(1==n.length)e[t]=a;else{for(var i=e,r=0;r<n.length-1;r++)i=i[n[r]];i[n[n.length-1]]=a}}},{key:"copyTransform",value:function(e){var t=e.position,a=e.rotation,n=e.scale;return{position:{x:t.x,y:t.y,z:t.z},rotation:{x:a.x,y:a.y,z:a.z},scale:{x:n.x,y:n.y,z:n.z}}}},{key:"copyMaterialParam",value:function(e){if(!e)return null;var t=A.find(function(t){return t.type==e.type}),a={};for(var n in t.param)"normalScale"==n?a[n]=e[n]?e[n].x:.1:this.checkMap(n)?e[n]&&e[n].image?a[n]={image:e[n].image.currentSrc,repeatX:e[n].repeat.x,repeatY:e[n].repeat.y}:a[n]={}:a[n]=e[n];return a}},{key:"getDragParent",value:function(e){var t=e,a=0;while(t=t.parent){if("load_scene"==t.name)return t;if(++a>20)return null}return null}}]),e}();D.TYPE_NUMBER="type number",D.TYPE_COLOR="type color",D.TYPE_IMAGE="type image",D.TYPE_SWITCH="type switch";var R,z=function(e){function t(e,a){var n;return Object(f["a"])(this,t),n=Object(p["a"])(this,Object(v["a"])(t).call(this,e,a)),n.helpVisible=!0,n.dragItem=new L["Mesh"](new L["SphereBufferGeometry"](.5),new L["MeshNormalMaterial"]),n.dragItem.name="custom drag",n.name="CustomAmbientLight",n.add(n.dragItem),n}return Object(g["a"])(t,e),Object(O["a"])(t,[{key:"update",value:function(){this.dragItem.lookAt(new L["Vector3"])}},{key:"parameters",get:function(){return{color:this.color,intensity:this.intensity,helpVisible:this.helpVisible}}}]),t}(L["AmbientLight"]),H=function(e){function t(e,a){var n;return Object(f["a"])(this,t),n=Object(p["a"])(this,Object(v["a"])(t).call(this,e,a)),n.helpVisible=!0,n.dragItem=new L["Mesh"](new L["BoxBufferGeometry"](1,1,.2),new L["MeshNormalMaterial"]),n.dragItem.name="custom drag",n.name="CustomDirectionalLight",n.castShadow=!0,n.shadow.mapSize.width=512,n.shadow.mapSize.height=512,n.shadow.camera.near=.5,n.shadow.camera.far=500,n.add(n.dragItem),n}return Object(g["a"])(t,e),Object(O["a"])(t,[{key:"update",value:function(){this.dragItem.lookAt(new L["Vector3"])}},{key:"parameters",get:function(){return{color:this.color,intensity:this.intensity,helpVisible:this.helpVisible}}}]),t}(L["DirectionalLight"]),F=function(e){function t(e,a,n){var i;return Object(f["a"])(this,t),i=Object(p["a"])(this,Object(v["a"])(t).call(this,e,a,n)),i.helpVisible=!0,i.dragItem=new L["Mesh"](new L["BoxBufferGeometry"],new L["MeshNormalMaterial"]),i.dragItem.name="custom drag",i.name="CustomHemisphereLight",i.add(i.dragItem),i}return Object(g["a"])(t,e),Object(O["a"])(t,[{key:"update",value:function(){this.dragItem.lookAt(new L["Vector3"])}},{key:"parameters",get:function(){return{skyColor:this.skyColor,groundColor:this.groundColor,intensity:this.intensity,helpVisible:this.helpVisible}}}]),t}(L["HemisphereLight"]),Y=function(e){function t(e,a,n,i){var r;return Object(f["a"])(this,t),r=Object(p["a"])(this,Object(v["a"])(t).call(this,e,a,n,i)),r.helpVisible=!0,r.dragItem=new L["Mesh"](new L["SphereBufferGeometry"](.4),new L["MeshNormalMaterial"]),r.dragItem.name="custom drag",r.name="CustomPointLight",r.castShadow=!0,r.add(r.dragItem),r}return Object(g["a"])(t,e),Object(O["a"])(t,[{key:"update",value:function(){this.dragItem.lookAt(new L["Vector3"])}},{key:"parameters",get:function(){return{color:this.color,intensity:this.intensity,distance:this.distance,decay:this.decay,helpVisible:this.helpVisible}}}]),t}(L["PointLight"]),W=function(e){function t(e,a,n,i,r,s){var o;return Object(f["a"])(this,t),o=Object(p["a"])(this,Object(v["a"])(t).call(this,e,a,n,i,r,s)),o.helpVisible=!0,o.dragItem=new L["Mesh"](new L["BoxBufferGeometry"](.4),new L["MeshNormalMaterial"]),o.dragItem.name="custom drag",o.name="CustomSpotLight",o.castShadow=!0,o.add(o.dragItem),o}return Object(g["a"])(t,e),Object(O["a"])(t,[{key:"update",value:function(){this.dragItem.lookAt(new L["Vector3"])}},{key:"parameters",get:function(){return{color:this.color,intensity:this.intensity,distance:this.distance,angle:this.angle,exponent:this.exponent,decay:this.decay,helpVisible:this.helpVisible}}}]),t}(L["SpotLight"]),U=function(e){function t(e,a,n,i){var r;return Object(f["a"])(this,t),r=Object(p["a"])(this,Object(v["a"])(t).call(this,e,a,n,i)),r.helpVisible=!0,r.dragItem=new L["Mesh"](new L["BoxBufferGeometry"](.2),new L["MeshNormalMaterial"]),r.dragItem.name="custom drag",r.name="CustomRectAreaLight",r.add(r.dragItem),r}return Object(g["a"])(t,e),Object(O["a"])(t,[{key:"update",value:function(){this.dragItem.lookAt(new L["Vector3"])}},{key:"parameters",get:function(){return{color:this.color,intensity:this.intensity,width:this.width,height:this.height,helpVisible:this.helpVisible}}}]),t}(L["RectAreaLight"]),X=(n("63d9"),function(){function e(t){Object(f["a"])(this,e),this.scene=t}return Object(O["a"])(e,[{key:"drawBufferData",value:function(e,t,a,n){var i=new Float32Array(e),r=new Float32Array(t),s=new Float32Array(a),o=new L["BufferGeometry"];o.addAttribute("position",new L["BufferAttribute"](i,3)),o.addAttribute("normal",new L["BufferAttribute"](r,3)),o.addAttribute("uv",new L["BufferAttribute"](s,2)),o.setIndex(n);var l=new L["Mesh"](o,new L["MeshBasicMaterial"]({color:16750848}));return this.scene.add(l),l}},{key:"selfDraw",value:function(){for(var e=new L["BufferGeometry"],t=[],a=[],n=[],i=[],r=20,s=10,o=r/2,l=r/s,c=0;c<=s;c++)for(var u=c*l-o,m=0;m<=s;m++){var h=m*l-o;a.push(h,-u,0),n.push(0,0,1);var d=Math.random(),f=Math.random();i.push(d,f,1)}for(c=0;c<s;c++)for(m=0;m<s;m++){var p=c*(s+1)+(m+1),v=c*(s+1)+m,g=(c+1)*(s+1)+m,b=(c+1)*(s+1)+(m+1);t.push(p,v,b),t.push(v,g,b)}e.setIndex(t),e.addAttribute("position",new L["Float32BufferAttribute"](a,3)),e.addAttribute("normal",new L["Float32BufferAttribute"](n,3)),e.addAttribute("color",new L["Float32BufferAttribute"](i,3));var y=new L["MeshPhongMaterial"]({specular:1118481,shininess:250,side:L["DoubleSide"],vertexColors:L["VertexColors"]}),w=new L["Mesh"](e,y);w.position.set(0,0,0),this.scene.add(w)}}]),e}()),J=function(){function e(t){var a=this;Object(f["a"])(this,e),this.dragList=[],G.ins.init(t),this.canvas=t,this.renderer=new L["WebGLRenderer"]({canvas:t,antialias:!0}),this.scene=new L["Scene"],this.camera=new L["PerspectiveCamera"](75,window.innerWidth/window.innerHeight,.1,100),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(new L["Color"](16777215)),this.renderer.shadowMap.enabled=!0,this.camera.position.set(3,4,5),this.camera.lookAt(new L["Vector3"]),this.orbitControls=new S["a"](this.camera,t),this.transformControls=new V["a"](this.camera,this.renderer.domElement),this.transformControls.addEventListener("dragging-changed",function(e){a.orbitControls.enabled=!e.value}),this.transformControls.addEventListener("objectChange",function(e){-1!=a.transformControls.object.name.indexOf("Light")?a.sendLightInfo(a.transformControls.object):a.sendMeshInfo(a.transformControls.object),a.scene.add(a.transformControls)}),this.rayCaster=new L["Raycaster"],t.addEventListener("mousedown",function(e){a.selectObject(e)}),this.jsz=new X(this.scene),window.addEventListener("resize",function(e){return a.onResize(e)},!1),window.addEventListener("keydown",function(e){switch(console.log(e.keyCode),e.keyCode){case 81:a.transformControls.setSpace("local"===a.transformControls.space?"world":"local");break;case 87:a.transformControls.setMode("translate");break;case 69:a.transformControls.setMode("rotate");break;case 82:a.transformControls.setMode("scale");break;case 71:a.grid.visible=!a.grid.visible;break}}),this.grid=new L["GridHelper"](80,80,13560057,15790320),this.grid.material.transparent=!0,this.grid.material.opacity=.4,this.scene.add(this.grid),this.init()}return Object(O["a"])(e,[{key:"setStats",value:function(e){this.stats=e}},{key:"onResize",value:function(e){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}},{key:"deleteItem",value:function(){var e=this.transformControls.object;e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose(),this.scene.remove(e),this.scene.remove(this.transformControls),this.dragList=this.dragList.filter(function(t){return t!=e})}},{key:"copyItem",value:function(){var e=this.transformControls.object,t=e.clone();this.scene.add(t),this.transformControls.attach(t),this.scene.add(this.transformControls),this.dragList.push(t),e.name.match(/Custom.*Light/)?this.sendLightInfo(t):this.sendMeshInfo(t)}},{key:"changeItemTransform",value:function(e){var t=this.transformControls.object;t.position.set(e.position.x,e.position.y,e.position.z),t.rotation.set(e.rotation.x,e.rotation.y,e.rotation.z),t.scale.set(e.scale.x,e.scale.y,e.scale.z),this.sendMeshInfo(t)}},{key:"changeGeometryParam",value:function(e){var t,a=this.transformControls.object;"BoxBufferGeometry"==a.name?t=new L["BoxBufferGeometry"](e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments):"SphereBufferGeometry"==a.name?t=new L["SphereBufferGeometry"](e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength):"IcosahedronBufferGeometry"==a.name?t=new L["IcosahedronBufferGeometry"](e.radius,e.detail):"CylinderBufferGeometry"==a.name?t=new L["CylinderBufferGeometry"](e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength):"OctahedronBufferGeometry"==a.name?t=new L["OctahedronBufferGeometry"](e.radius,e.detail):"TorusBufferGeometry"==a.name?t=new L["TorusBufferGeometry"](e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc):"ConeBufferGeometry"==a.name?t=new L["ConeBufferGeometry"](e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength):"PlaneBufferGeometry"==a.name&&(t=new L["PlaneBufferGeometry"](e.width,e.height,e.widthSegments,e.heightSegments)),this.updateGroupGeometry(a,t),this.sendMeshInfo(a)}},{key:"toggerMaterial",value:function(e){var t,a=this.curMesh;"MeshBasicMaterial"==e?t=new L["MeshBasicMaterial"]:"MeshNormalMaterial"==e?t=new L["MeshNormalMaterial"]:"MeshLambertMaterial"==e?t=new L["MeshLambertMaterial"]:"MeshPhongMaterial"==e?t=new L["MeshPhongMaterial"]:"MeshToonMaterial"==e?t=new L["MeshToonMaterial"]:"MeshStandardMaterial"==e&&(t=new L["MeshStandardMaterial"]),a.material=t,this.sendMeshInfo(a)}},{key:"changeCommonMaterial",value:function(e,t){var a=this.curMesh,n=D.getType(e);"normalScale"==e?a.material[e]&&a.material[e].set(1,-1).multiplyScalar(Number(t)):n==D.TYPE_COLOR?a.material[e]=new L["Color"](t):n==D.TYPE_NUMBER?a.material[e]=Number(t):n==D.TYPE_SWITCH&&(a.material[e]=Boolean(t)),this.sendMeshInfo(a)}},{key:"changeRepeatMaterial",value:function(e,t,a){var n=this.curMesh;n.material[e]&&("repeatX"==t?n.material[e].repeat.x=Number(a):"repeatY"==t&&(n.material[e].repeat.y=Number(a)),n.material[e].needsUpdate=!0,n.material.needsUpdate=!0,this.sendMeshInfo(n))}},{key:"changeTextureMaterial",value:function(e,t){var a=this,n=this.curMesh,i=(new L["TextureLoader"]).load(t,function(){n.material[e].needsUpdate=!0,n.material.needsUpdate=!0,a.sendMeshInfo(n)});i.wrapS=L["RepeatWrapping"],i.wrapT=L["RepeatWrapping"],n.material[e]=i}},{key:"changeFog",value:function(e){if(e.visible){var t=this.scene.fog;t?(t.color=new L["Color"](e.color),t.near=Number(e.near),t.far=Number(e.far)):this.scene.fog=new L["Fog"](new L["Color"](e.color).getHex(),Number(e.near),Number(e.far))}else this.scene.fog=null;this.renderer.setClearColor(new L["Color"](e.color))}},{key:"deleteTexture",value:function(e){var t=this.curMesh;t.material[e]=null,t.material.needsUpdate=!0,this.sendMeshInfo(t)}},{key:"changeLightParam",value:function(e,t){var a=this.transformControls.object,n=D.getType(e);n==D.TYPE_COLOR?a[e]=new L["Color"](t):n==D.TYPE_NUMBER?a[e]=Number(t):n==D.TYPE_SWITCH&&(a[e]=Boolean(t)),this.sendLightInfo(a)}},{key:"sendLightInfo",value:function(e){if(e.name.match(/Custom.*Light/)){var t=D.copyTransform(e);G.ins.send(G.SELECT_LIGHT,{name:e.name,parameters:e.parameters,transform:t}),e.update()}}},{key:"sendMeshInfo",value:function(e){if(e){this.curMesh=e;var t=e.geometry?e.geometry.parameters:null,a=D.copyMaterialParam(e.material),n=D.copyTransform(e);G.ins.send(G.SELECT_ITEM,{name:e.name,parameters:t,material:a,materialType:e.material?e.material.type:"",transform:n})}}},{key:"selectObject",value:function(e){e.preventDefault();var t=new L["Vector2"];t.x=e.clientX/window.innerWidth*2-1,t.y=-e.clientY/window.innerHeight*2+1,this.rayCaster.setFromCamera(t,this.camera);var a=this.rayCaster.intersectObjects(this.dragList,!0);if(a[0]){var n=a[0].object;if("custom drag"==n.name)this.transformControls.attach(n.parent),this.sendLightInfo(n.parent),this.sendItemInfo(null);else if("load_mesh"==n.name){var i=D.getDragParent(n);i&&(this.transformControls.attach(i),this.sendMeshInfo(n),this.sendItemInfo(n))}else this.transformControls.attach(n),this.sendMeshInfo(n),this.sendItemInfo(n);this.scene.add(this.transformControls)}else this.orbitControls.enabled=!0,this.sendItemInfo(null);console.log(a)}},{key:"updateGroupGeometry",value:function(e,t){t.isGeometry&&(t=(new L["BufferGeometry"]).fromGeometry(t)),e.geometry.dispose(),e.geometry=t,this.sendItemInfo(e)}},{key:"getCanvas",value:function(e,t){var a=512,n=512,i=document.createElement("canvas");i.width=a,i.height=n;var r=i.getContext("2d");return r.font="400px bold",r.fillStyle=t,r.textAlign="center",r.textBaseline="middle",r.fillText(e,a/2,n/2),i}},{key:"addWorldTip",value:function(e,t,a){var n=new L["CanvasTexture"](this.getCanvas(e,t)),i=new L["SpriteMaterial"]({map:n,transparent:!0,sizeAttenuation:!0}),r=new L["Sprite"](i);r.position.copy(a),this.grid.add(r)}},{key:"init",value:function(){this.addWorldTip("x","#ff0000",new L["Vector3"](42,.5,0)),this.addWorldTip("-x","#ff0000",new L["Vector3"](-42,.5,0)),this.addWorldTip("z","#0000ff",new L["Vector3"](0,.5,42)),this.addWorldTip("-z","#0000ff",new L["Vector3"](0,.5,-42)),this.animate()}},{key:"addLight",value:function(e){var t;"AmbientLight"==e?t=new z(16711680):"DirectionalLight"==e?t=new H(16711680):"HemisphereLight"==e?t=new F(16711680):"PointLight"==e?t=new Y(16711680):"SpotLight"==e?t=new W(16711680):"RectAreaLight"==e&&(t=new U(16711680)),t&&(this.scene.add(t),this.dragList.push(t),this.transformControls.attach(t),this.scene.add(this.transformControls),this.orbitControls.enabled=!1),this.sendItemInfo(t)}},{key:"animate",value:function(){var e=this;requestAnimationFrame(function(){e.animate()}),this.renderer.render(this.scene,this.camera),this.stats&&this.stats.update()}},{key:"getFrame",value:function(e){var t=new L["MeshBasicMaterial"]({color:16777215,opacity:.1,wireframe:!0,transparent:!0,depthTest:!0,depthWrite:!0});console.log("getFrame");var a=new L["Mesh"](e,t);return a.name="frame_"+e.type,a}},{key:"addObject",value:function(e,t){var a;switch(console.log("add "+e),e){case"BoxBufferGeometry":a=new L["BoxBufferGeometry"](1,1,1);break;case"SphereBufferGeometry":a=new L["SphereBufferGeometry"](.5,12,12);break;case"IcosahedronBufferGeometry":a=new L["IcosahedronBufferGeometry"](1,0);break;case"CylinderBufferGeometry":a=new L["CylinderBufferGeometry"](.5,1,2,8,8);break;case"OctahedronBufferGeometry":a=new L["OctahedronBufferGeometry"](.5,0);break;case"TorusBufferGeometry":a=new L["TorusBufferGeometry"](2,.5,8,20,2*Math.PI);break;case"ConeBufferGeometry":a=new L["ConeBufferGeometry"](1,3,8,3);break;case"PlaneBufferGeometry":a=new L["PlaneBufferGeometry"](20,20);break;default:break}if(a){var n=new L["Vector3"];n.set(t.clientX/window.innerWidth*2-1,-t.clientY/window.innerHeight*2+1,.5),n.unproject(this.camera);var i=n.sub(this.camera.position).normalize(),r=-this.camera.position.z/i.z,s=(this.camera.position.clone().add(i.multiplyScalar(r)),new L["MeshStandardMaterial"]({color:(new L["Color"]).setHSL(Math.random(),1,.75),emissive:468276,side:L["FrontSide"],transparent:!0,opacity:1,flatShading:!0,wireframe:!1})),o=new L["Mesh"](a,s);o.name=e,o.castShadow=!0,o.receiveShadow=!0,this.scene.add(o),this.transformControls.attach(o),this.orbitControls.enabled=!1,this.scene.add(this.transformControls),this.dragList.push(o),this.sendItemInfo(o)}else console.log("no geo")}},{key:"sendItemInfo",value:function(e){var t=null;if(e&&e.geometry){var a=e.geometry;e.geometry.isGeometry&&(a=(new L["BufferGeometry"]).fromGeometry(e.geometry)),t=a.attributes,t.index=e.geometry.getIndex()}G.ins.send(G.ITEM_INFO,t)}},{key:"exportObject",value:function(){var e=this,t=[];this.scene.children.forEach(function(a){-1==e.dragList.indexOf(a)&&(a.visible=!1,t.push(a))}),N(this.scene),t.forEach(function(e){e.visible=!0})}},{key:"loadObject",value:function(e){var t=this,a=new $["a"];a.parse(e,"",function(e){var a;(a=t.scene).add.apply(a,Object(j["a"])(e.scene.children))})}},{key:"mergeTest",value:function(){var e=!1,t=3e3;if(e)for(var a=0;a<t;a++){var n=new L["BoxGeometry"](1,1,1),i=new L["MeshPhongMaterial"]({color:(new L["Color"]).setHSL(Math.random(),1,.75)}),r=new L["Mesh"](n,i),s=20*(.5-Math.random()),o=20*(.5-Math.random()),l=20*(.5-Math.random());r.position.set(s,o,l),this.scene.add(r),this.dragList.push(r)}else{var c=new L["Geometry"];for(a=0;a<t;a++){var u=new L["BoxGeometry"](1,1,1),m=new L["MeshPhongMaterial"]({color:(new L["Color"]).setHSL(Math.random(),1,.75)}),h=new L["Mesh"](u,m),d=20*(.5-Math.random()),f=20*(.5-Math.random()),p=20*(.5-Math.random());h.position.set(d,f,p),h.updateMatrix(),c.merge(u,h.matrix)}var v=new L["Mesh"](c);this.scene.add(v),this.dragList.push(v)}}},{key:"testJsz",value:function(){var e=new X(this.scene),t=[0,1,0,0,1,0,0,1,-0,-0,1,-0,-0,1,0,0,-1,1,1,-1,6123234262925839e-32,12246468525851679e-32,-1,-1,-1,-1,-18369701465288538e-32,-24492937051703357e-32,-1,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,1,-1,6123234262925839e-32,12246468525851679e-32,-1,-1,-1,-1,-18369701465288538e-32,-24492937051703357e-32,-1,1],a=[0,.4472135901451111,.8944271802902222,.8944271802902222,.4472135901451111,5476786989387483e-32,10953573978774966e-32,.4472135901451111,-.8944271802902222,-.8944271802902222,.4472135901451111,-16430361299034693e-32,-2190714795754993e-31,.4472135901451111,.8944271802902222,0,.4472135901451111,.8944271802902222,.8944271802902222,.4472135901451111,5476786989387483e-32,10953573978774966e-32,.4472135901451111,-.8944271802902222,-.8944271802902222,.4472135901451111,-16430361299034693e-32,-2190714795754993e-31,.4472135901451111,.8944271802902222,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],n=[0,1,.25,1,.5,1,.75,1,1,1,0,0,.25,0,.5,0,.75,0,1,0,.5,.5,.5,.5,.5,.5,.5,.5,1,.5,.5,0,0,.5,.5,1,1,.5],i=[0,5,1,5,6,1,1,6,2,6,7,2,2,7,3,7,8,3,3,8,4,8,9,4,15,14,10,16,15,11,17,16,12,18,17,13],r=e.drawBufferData(t,a,n,i);this.dragList.push(r)}},{key:"addCustomGeometry",value:function(e){if(e){var t=JSON.parse(e.position),a=JSON.parse(e.normal),n=JSON.parse(e.uv),i=JSON.parse(e.index),r=this.jsz.drawBufferData(t,a,n,i);this.dragList.push(r)}}},{key:"loadTest",value:function(){var e=this,t=new L["BoxBufferGeometry"](1,1,1);console.log(t.attributes);var a=new L["BoxBufferGeometry"](1,1,1);console.log(t),console.log(a);var n=new $["a"];n.setPath("asset/obj/"),n.load("win.gltf",function(t){console.log("gltf"),console.log(t),t.scene.traverse(function(t){t.isMesh&&(t.name="load_mesh",e.dragList.push(t),t.updateMatrix())});var a=(new L["Box3"]).setFromObject(t.scene).getSize(new L["Vector3"]),n=Math.max(a.x,a.y,a.z),i=10/n;t.scene.scale.set(i,i,i),e.scene.add(t.scene),t.scene.name="load_scene",e.dragList.push(t.scene);var r=(new L["Box3"]).setFromObject(t.scene),s=(r.min.x+r.max.x)/2,o=(r.min.y+r.max.y)/2,l=(r.min.z+r.max.z)/2;t.scene.position.set(0-s,0-o,0-l)})}}]),e}(),q=function(e){function t(){return Object(f["a"])(this,t),Object(p["a"])(this,Object(v["a"])(t).apply(this,arguments))}return Object(g["a"])(t,e),Object(O["a"])(t,[{key:"mounted",value:function(){var e=this;R=new J(this.$refs.canvas),this.$refs.canvas.addEventListener("mouseenter",this.mouseenter),G.ins.on(G.SELECT_ITEM,function(t){e.changeSelectItem(t)}),G.ins.on(G.SELECT_LIGHT,function(t){e.changeSelectLight(t)}),G.ins.on(G.ITEM_INFO,function(t){e.changeItemInfo(t)}),G.ins.on(G.CHANGE_MATERIAL,function(t){e.changeMaterial(t)}),G.ins.on(G.DELETE_TEXTURE,function(t){e.deleteTexture(t)}),G.ins.on(G.DELETE_ITEM,function(t){e.deleteItem(t)}),G.ins.on(G.COPY_ITEM,function(t){e.copyItem(t)}),G.ins.on(G.ADD_LIGHT,function(t){e.addLight(t)}),G.ins.on(G.CUSTOM_GEOMETRY,function(t){e.addCustomGeometry(t)}),G.ins.on(G.CHANGE_ITEM_PARAM,function(t){e.changeItemParam(t)}),this.initStats()}},{key:"initStats",value:function(){}},{key:"addLight",value:function(e){R.addLight(e.detail)}},{key:"changeMaterial",value:function(e){R.toggerMaterial(e.detail)}},{key:"deleteTexture",value:function(e){R.deleteTexture(e.detail)}},{key:"changeItemParam",value:function(e){console.log("Paramview组件发过来的消息"),console.log(e.detail);var t=e.detail.value,a=e.detail.name.split(".");if("geometry"==a[0]){var n=Object.assign(this.$store.state.curParam,{});n[a[1]]=Number(t),R.changeGeometryParam(n)}else if("position"==a[0]||"rotation"==a[0]||"scale"==a[0]){var i=Object.assign(this.$store.state.curTransform,{});i[a[0]][a[1]]=Number(t),R.changeItemTransform(i)}else if("material"==a[0]){var r=Object.assign(this.$store.state.curMaterial,{});D.checkMap(a[1])?("image"==a[2]?R.changeTextureMaterial(a[1],t):R.changeRepeatMaterial(a[1],a[2],t),r[a[1]]||(r[a[1]]={}),r[a[1]][a[2]]=t):(r[a[1]]=t,R.changeCommonMaterial(a[1],t))}else if("light"==a[0])R.changeLightParam(a[1],t);else if("fog"==a[0]){var s=Object.assign(this.$store.state.fog,{});s[a[1]]=t,this.$store.commit("changeFog",s),R.changeFog(s)}}},{key:"deleteItem",value:function(e){R.deleteItem()}},{key:"copyItem",value:function(e){R.copyItem()}},{key:"mouseenter",value:function(e){this.$store.state.dragItem&&R.addObject(this.$store.state.dragItem.name,e)}},{key:"changeSelectItem",value:function(e){this.$store.commit("changeCurItemName",e.detail.name),this.$store.commit("changeCurDragType","mesh"),this.$store.commit("changeDrawer",!0),this.$store.commit("changeMaterialType",e.detail.materialType),this.$store.commit("changeCurMaterial",e.detail.material),this.$store.commit("changeCurParams",e.detail.parameters),this.$store.commit("changeCurTransform",e.detail.transform)}},{key:"changeSelectLight",value:function(e){this.$store.commit("changeCurItemName",e.detail.name),this.$store.commit("changeCurDragType","light"),this.$store.commit("changeDrawer",!0),this.$store.commit("changeCurParams",e.detail.parameters),this.$store.commit("changeCurTransform",e.detail.transform)}},{key:"changeItemInfo",value:function(e){this.$store.commit("changeItemInfo",e.detail)}},{key:"changeCurTransform",value:function(e){this.$store.commit("changeCurTransform",e.detail)}},{key:"handleFile",value:function(e){console.log(e);var t=new FileReader;t.readAsArrayBuffer(e.target.files[0]),t.onload=function(e){console.info(t.result);var a=new DataView(t.result);console.log(a),R.loadObject(a.buffer)}}},{key:"handleLoad",value:function(){this.$refs.file.click()}},{key:"handleCustomGeometry",value:function(){this.$store.commit("changeCustomGeometryVisible",!0)}},{key:"handleSave",value:function(){R.exportObject()}},{key:"handleTest",value:function(){R.loadTest()}},{key:"addCustomGeometry",value:function(e){R.addCustomGeometry(e.detail)}}]),t}(y["d"]);b["a"]([Object(y["b"])()],q.prototype,"msg",void 0),q=b["a"]([y["a"]],q);var Q=q,K=Q,Z=(n("3182"),Object(o["a"])(K,I,E,!1,null,"6dc59fe9",null)),ee=Z.exports,te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"left-side"},[a("el-collapse",{attrs:{accordion:""},on:{change:e.handleCollapse},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"几何物体",name:"0"}},e._l(e.geometryList,function(t,n){return a("div",{key:t.name,staticClass:"geometry"},[a("img",{staticClass:"img",attrs:{draggable:"false",src:t.img,"data-idx":n}}),a("div",{staticClass:"tip"},[e._v(e._s(t.name))])])}),0),a("el-collapse-item",{attrs:{title:"灯光",name:"1"}},e._l(e.lightList,function(t,n){return a("div",{key:t.name,staticClass:"light"},[a("el-button",{attrs:{"data-idx":n},on:{click:e.addLight}},[e._v(e._s(t.name))])],1)}),0),a("el-collapse-item",{attrs:{title:"雾气",name:"2"}},[a("FogView")],1)],1)],1)},ae=[],ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fog-view"},[a("TransformView",{attrs:{label:"fog",list:e.fog}})],1)},ie=[],re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"transform-view"},e._l(e.list,function(t,n){return a("div",{key:n,staticClass:"edit"},[a("ParamView",{attrs:{label:n,value:t,pname:e.label+"."+n}})],1)}),0)},se=[],oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"param-view"},[a(e.aim,{tag:"component",attrs:{label:e.label,value:e.value,pname:e.pname},on:{change:e.handleChange}})],1)},le=[],ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"number-view"},[a("div",{staticClass:"param"},[a("div",{staticClass:"state"},[a("div",{staticClass:"label"},[e._v(e._s(e.label)+":")]),a("input",{staticClass:"value",attrs:{type:"text","data-pname":e.pname},domProps:{value:e.value},on:{input:e.handleChange}})]),a("div",{staticClass:"block"},[a("input",{staticClass:"range",attrs:{type:"range",min:e.min,max:e.max,step:e.step,"data-pname":e.pname},domProps:{value:e.value},on:{input:e.handleChange}}),a("i",{staticClass:"el-icon-s-tools setting",on:{click:function(t){e.configVisible=!e.configVisible}}})]),e.configVisible?a("div",{staticClass:"config"},[a("div",{staticClass:"row"},[a("div",{staticClass:"label"},[e._v("最小值:")]),a("input",{staticClass:"value",attrs:{type:"text","data-pname":"min"},domProps:{value:e.min},on:{input:e.handleSetting}})]),a("div",{staticClass:"row"},[a("div",{staticClass:"label"},[e._v("最大值:")]),a("input",{staticClass:"value",attrs:{type:"text","data-pname":"max"},domProps:{value:e.max},on:{input:e.handleSetting}})]),a("div",{staticClass:"row"},[a("div",{staticClass:"label"},[e._v("步长:")]),a("input",{staticClass:"value",attrs:{type:"text","data-pname":"step"},domProps:{value:e.step},on:{input:e.handleSetting}})])]):e._e()])])},ue=[],me={data:function(){return{configVisible:!1,min:0,max:2,step:.01}},props:["label","value","pname"],computed:{},mounted:function(){},methods:{handleChange:function(e){this.$emit("change",this.pname,e.target.value)},handleSetting:function(e){var t=e.target.dataset.pname;this[t]=e.target.value}}},he=me,de=(n("c4a6"),Object(o["a"])(he,ce,ue,!1,null,"268d9bea",null)),fe=de.exports,pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"color-view"},[a("div",{staticClass:"param"},[a("div",{staticClass:"state"},[a("div",{staticClass:"label"},[e._v(e._s(e.label)+":")]),a("input",{staticClass:"value",attrs:{type:"color","data-pname":e.pname},domProps:{value:e.color},on:{input:e.handleChange}})])])])},ve=[],ge=(n("a481"),n("7618"));function be(e,t,a){return ye(e)+ye(t)+ye(a)}function ye(e){return null==e?"00":(e=parseInt(e),0==e||isNaN(e)?"00":(e=Math.max(0,e),e=Math.min(e,255),e=Math.round(e),"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16)))}var we=be,Ce={data:function(){return{configVisible:!1,min:0,max:10,step:1}},props:["label","value","pname"],computed:{color:function(){var e;if(console.log("color ==== "+Object(ge["a"])(this.value)),"string"==typeof this.value)e=this.value.replace("0x","#");else{var t=255*this.value.r,a=255*this.value.g,n=255*this.value.b;e="#"+we(t,a,n)}return console.log(this.value,e),e}},mounted:function(){},methods:{handleChange:function(e){var t=e.target.value;this.$emit("change",this.pname,t)},handleSetting:function(e){var t=e.target.dataset.pname;this[t]=e.target.value}}},_e=Ce,Me=(n("0432"),Object(o["a"])(_e,pe,ve,!1,null,"3897a4ed",null)),Te=Me.exports,ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"switch-view"},[a("div",{staticClass:"param"},[a("div",{staticClass:"state"},[a("div",{staticClass:"label"},[e._v(e._s(e.label)+":")]),a("div",{staticClass:"color",class:{active:e.value},on:{click:e.handleChange}},[a("div",{staticClass:"bar"})])])])])},xe=[],Ie={data:function(){return{}},props:["label","value","pname"],computed:{},mounted:function(){},methods:{handleChange:function(e){this.$emit("change",this.pname,!this.value)}}},Ee=Ie,Oe=(n("aa34"),Object(o["a"])(Ee,ke,xe,!1,null,"269c7022",null)),je=Oe.exports,Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"image-view"},[a("div",{staticClass:"param"},[a("div",{staticClass:"state"},[a("div",{staticClass:"label"},[e._v(e._s(e.label)+":")]),e.value&&e.value.image?a("div",{staticClass:"img",style:{"background-image":"url("+e.value.image+")"},on:{click:e.handleEdit}}):e._e(),a("div",{staticClass:"choose",on:{click:e.handleEdit}},[a("i",{staticClass:"el-icon-picture-outline"}),e._v(" 修改")]),a("div",{staticClass:"delete",on:{click:e.handleDelete}},[a("i",{staticClass:"el-icon-delete"}),e._v(" 删除")])]),e.value&&e.value.repeatX?a("NumberView",{attrs:{label:"repeatX",value:e.value.repeatX,pname:"material."+e.label+".repeatX"},on:{change:e.handleChange}}):e._e(),e.value&&e.value.repeatY?a("NumberView",{attrs:{label:"repeatY",value:e.value.repeatY,pname:"material."+e.label+".repeatY"},on:{change:e.handleChange}}):e._e()],1)])},Se=[],Ve={data:function(){return{}},props:["label","value","pname"],components:{NumberView:fe},computed:{editing:function(){return this.$store.state.changeTexureViewVisible}},watch:{},mounted:function(){},methods:{handleChange:function(e,t){this.$emit("change",e,t)},handleEdit:function(e){this.$store.commit("changeTexureViewVisible",!0),this.$store.commit("changeTexureViewType",this.pname+".image")},handleDelete:function(e){G.ins.send(G.DELETE_TEXTURE,this.label)}}},$e=Ve,Ge=(n("d99b"),Object(o["a"])($e,Le,Se,!1,null,"bf6d15bc",null)),Pe=Ge.exports,Be={data:function(){return{}},props:["label","value","pname"],components:{NumberView:fe,ColorView:Te,SwitchView:je,ImageView:Pe},computed:{material:function(){return this.$store.state.curMaterial},aim:function(){var e=D.getType(this.label);switch(e){case D.TYPE_SWITCH:return"SwitchView";case D.TYPE_COLOR:return"ColorView";case D.TYPE_IMAGE:return"ImageView";default:return"NumberView"}}},mounted:function(){},methods:{handleChange:function(e,t){G.ins.send(G.CHANGE_ITEM_PARAM,{name:e,value:t})}}},Ne=Be,Ae=(n("8a01"),Object(o["a"])(Ne,oe,le,!1,null,"44e56d92",null)),De=Ae.exports,Re={data:function(){return{}},props:["list","label"],components:{ParamView:De},computed:{},mounted:function(){},methods:{handleChange:function(t,a){var n=e.target.dataset.name;console.log(n);var i=n.split(".");if(1==i.length){var r={};r[n]=Number(e.target.value);var s=Object.assign(this.$store.state.curParam,r);this.$store.commit("changeCurParams",s),console.log("changeCurParams"),G.ins.send(G.CHANGE_PARAM,s)}else{var o=Object.assign(this.$store.state.curTransform,{});o[i[0]][i[1]]=Number(e.target.value),this.$store.commit("changeCurTransform",o),console.log("changeCurTransform"),G.ins.send(G.CHANGE_TRANSFORM,o)}}}},ze=Re,He=(n("d3e9"),Object(o["a"])(ze,re,se,!1,null,"36f329d9",null)),Fe=He.exports,Ye={data:function(){return{}},components:{TransformView:Fe},computed:{fog:function(){return this.$store.state.fog}}},We=Ye,Ue=(n("31ad"),Object(o["a"])(We,ne,ie,!1,null,"58380a06",null)),Xe=Ue.exports,Je=function(e){function t(){var e;return Object(f["a"])(this,t),e=Object(p["a"])(this,Object(v["a"])(t).apply(this,arguments)),e.tip="ok",e.activeNames="0",e.geometryList=[],e.lightList=[],e}return Object(g["a"])(t,e),Object(O["a"])(t,[{key:"mounted",value:function(){var e=this;this.$axios.get("asset/data.json").then(function(t){e.geometryList=t.data.geometry,e.lightList=t.data.light}),this.$el.addEventListener("mousedown",function(t){var a=t.target;if("img"==a.className){var n=e.geometryList[a.dataset.idx];e.$store.commit("changeDrag",n),window.addEventListener("mousemove",e.mouseMove),window.addEventListener("mouseup",e.mouseUp)}})}},{key:"handleCollapse",value:function(e){console.log(e)}},{key:"mouseMove",value:function(e){}},{key:"mouseUp",value:function(e){window.removeEventListener("mousemove",this.mouseMove),window.removeEventListener("mouseup",this.mouseUp),this.$store.commit("changeDrag",null)}},{key:"addLight",value:function(e){var t=e.currentTarget,a=this.lightList[t.dataset.idx];G.ins.send(G.ADD_LIGHT,a.name)}}]),t}(y["d"]);b["a"]([Object(y["b"])()],Je.prototype,"msg",void 0),b["a"]([Object(y["c"])()],Je.prototype,"tip",void 0),b["a"]([Object(y["c"])()],Je.prototype,"activeNames",void 0),b["a"]([Object(y["c"])()],Je.prototype,"geometryList",void 0),b["a"]([Object(y["c"])()],Je.prototype,"lightList",void 0),Je=b["a"]([Object(y["a"])({components:{FogView:Xe}})],Je);var qe=Je,Qe=qe,Ke=(n("5f0c"),Object(o["a"])(Qe,te,ae,!1,null,"30790df2",null)),Ze=Ke.exports,et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"right-side",class:{open:e.drawer}},[a(e.aim,{tag:"component"})],1)},tt=[],at=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"material-view"},[a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleChoose}},[a("span",{staticClass:"el-dropdown-link"},[a("span",{staticClass:"mat-btn"},[e._v("当前材质："+e._s(e.materialType))]),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.list,function(t,n){return a("el-dropdown-item",{key:t.name,attrs:{command:n}},[e._v(e._s(t.name))])}),1)],1),e._l(e.material,function(e,t){return a("div",{key:t,staticClass:"edit"},[a("ParamView",{attrs:{label:t,value:e,pname:"material."+t}})],1)})],2)},nt=[],it={data:function(){return{cur:"",list:[]}},props:["materialType","material"],components:{ParamView:De},computed:{},mounted:function(){this.list=A},methods:{handleChoose:function(e){this.$store.state.materialType!=this.list[e].name&&G.ins.send(G.CHANGE_MATERIAL,this.list[e].name)},handleChange:function(e,t){}}},rt=it,st=(n("399a"),Object(o["a"])(rt,at,nt,!1,null,"7ecf9e53",null)),ot=st.exports,lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mesh-info"},[a("div",{staticClass:"title"},[a("div",{staticClass:"name"},[e._v("物体属性")]),a("div",{staticClass:"close",on:{click:e.handleClose}},[a("i",{staticClass:"el-icon-close"})])]),a("div",{staticClass:"cur-name"},[e._v(e._s(e.curItemName))]),a("el-collapse",{attrs:{accordion:""},on:{change:e.handleCollapse},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"材质",name:"0"}},[a("MaterialView",{attrs:{"material-type":e.materialType,material:e.material}})],1),a("el-collapse-item",{attrs:{title:"状态参数",name:"1"}},[a("TransformView",{attrs:{label:"geometry",list:e.list}})],1),a("el-collapse-item",{attrs:{title:"位置",name:"2"}},[a("TransformView",{attrs:{label:"position",list:e.curTransform.position}})],1),a("el-collapse-item",{attrs:{title:"旋转",name:"3"}},[a("TransformView",{attrs:{label:"rotation",list:e.curTransform.rotation}})],1),a("el-collapse-item",{attrs:{title:"缩放",name:"4"}},[a("TransformView",{attrs:{label:"scale",list:e.curTransform.scale}})],1),a("el-collapse-item",{attrs:{title:"数据",name:"5"}},[a("InfoView")],1)],1),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCopy}},[e._v("原地复制")]),a("el-button",{attrs:{type:"danger"},on:{click:e.handleDelete}},[e._v("删除物体")])],1)],1)},ct=[],ut=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"info-view"},[e.info?[e.info.position?a("div",{staticClass:"comm"},[a("div",{staticClass:"label",on:{click:function(t){return e.log(e.info.position)}}},[e._v("position")]),a("div",{staticClass:"info"},[a("div",{staticClass:"tip"},[e._v("length: "+e._s(e.info.position.count*e.info.position.itemSize))]),a("div",{staticClass:"tip"},[e._v("count: "+e._s(e.info.position.count))]),a("div",{staticClass:"tip"},[e._v("itemSize: "+e._s(e.info.position.itemSize))])])]):e._e(),e.info.normal?a("div",{staticClass:"comm"},[a("div",{staticClass:"label",on:{click:function(t){return e.log(e.info.normal)}}},[e._v("normal")]),a("div",{staticClass:"info"},[a("div",{staticClass:"tip"},[e._v("length: "+e._s(e.info.normal.count*e.info.normal.itemSize))]),a("div",{staticClass:"tip"},[e._v("count: "+e._s(e.info.normal.count))]),a("div",{staticClass:"tip"},[e._v("itemSize: "+e._s(e.info.normal.itemSize))])])]):e._e(),e.info.uv?a("div",{staticClass:"comm"},[a("div",{staticClass:"label",on:{click:function(t){return e.log(e.info.uv)}}},[e._v("uv")]),a("div",{staticClass:"info"},[a("div",{staticClass:"tip"},[e._v("length: "+e._s(e.info.uv.count*e.info.uv.itemSize))]),a("div",{staticClass:"tip"},[e._v("count: "+e._s(e.info.uv.count))]),a("div",{staticClass:"tip"},[e._v("itemSize: "+e._s(e.info.uv.itemSize))])])]):e._e(),e.info.index?a("div",{staticClass:"comm"},[a("div",{staticClass:"label",on:{click:function(t){return e.log(e.info.index)}}},[e._v("index")]),a("div",{staticClass:"info"},[a("div",{staticClass:"tip"},[e._v("length: "+e._s(e.info.index.count))])])]):e._e()]:[a("div",{staticClass:"none"},[e._v("无数据")])]],2)},mt=[],ht={data:function(){return{}},components:{},computed:{info:function(){return this.$store.state.itemInfo}},methods:{log:function(e){console.log(e.array)}}},dt=ht,ft=(n("08e4"),Object(o["a"])(dt,ut,mt,!1,null,"0fd2de4e",null)),pt=ft.exports,vt={data:function(){return{value:0,direction:"rtl",activeNames:"0"}},components:{MaterialView:ot,TransformView:Fe,InfoView:pt},computed:{list:function(){var e={},t=this.$store.state.curParam;for(var a in t)e[a]=t[a]||0;return e},curTransform:function(){var e=this.$store.state.curTransform;return e},materialType:function(){return this.$store.state.materialType},material:function(){return this.$store.state.curMaterial},drawer:function(){return this.$store.state.drawer},curItemName:function(){return this.$store.state.curItemName}},methods:{handleClose:function(){this.$store.commit("changeDrawer",!1)},handleCopy:function(){G.ins.send(G.COPY_ITEM)},handleDelete:function(){this.$store.commit("changeDrawer",!1),G.ins.send(G.DELETE_ITEM)},handleCollapse:function(e){console.log(e)},handleChange:function(e){}}},gt=vt,bt=(n("fa1a"),Object(o["a"])(gt,lt,ct,!1,null,"16bdd2d6",null)),yt=bt.exports,wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"light-info"},[a("div",{staticClass:"title"},[a("div",{staticClass:"name"},[e._v("灯光属性")]),a("div",{staticClass:"close",on:{click:e.handleClose}},[a("i",{staticClass:"el-icon-close"})])]),a("div",{staticClass:"cur-name"},[e._v(e._s(e.curItemName))]),a("el-collapse",{attrs:{accordion:""},on:{change:e.handleCollapse},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"状态参数",name:"1"}},[a("TransformView",{attrs:{label:"light",list:e.list}})],1),a("el-collapse-item",{attrs:{title:"位置",name:"2"}},[a("TransformView",{attrs:{label:"position",list:e.curTransform.position}})],1),a("el-collapse-item",{attrs:{title:"旋转",name:"3"}},[a("TransformView",{attrs:{label:"rotation",list:e.curTransform.rotation}})],1),a("el-collapse-item",{attrs:{title:"缩放",name:"4"}},[a("TransformView",{attrs:{label:"scale",list:e.curTransform.scale}})],1)],1),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCopy}},[e._v("原地复制")]),a("el-button",{attrs:{type:"danger"},on:{click:e.handleDelete}},[e._v("删除物体")])],1)],1)},Ct=[],_t={data:function(){return{value:0,direction:"rtl",activeNames:"0"}},components:{MaterialView:ot,TransformView:Fe},computed:{list:function(){var e={},t=this.$store.state.curParam;for(var a in t)e[a]=t[a]||0;return e},curTransform:function(){var e=this.$store.state.curTransform;return e},materialType:function(){return this.$store.state.materialType},material:function(){return this.$store.state.curMaterial},drawer:function(){return this.$store.state.drawer},curItemName:function(){return this.$store.state.curItemName}},methods:{handleClose:function(){this.$store.commit("changeDrawer",!1)},handleCopy:function(){G.ins.send(G.COPY_ITEM)},handleDelete:function(){this.$store.commit("changeDrawer",!1),G.ins.send(G.DELETE_ITEM)},handleCollapse:function(e){console.log(e)},handleChange:function(e){}}},Mt=_t,Tt=(n("225b"),Object(o["a"])(Mt,wt,Ct,!1,null,"5cd10d61",null)),kt=Tt.exports,xt={data:function(){return{value:0,direction:"rtl",activeNames:["0"]}},components:{MaterialView:ot,TransformView:Fe,MeshInfo:yt,LightInfo:kt},computed:{list:function(){var e={},t=this.$store.state.curParam;for(var a in t)e[a]=t[a]||0;return e},curTransform:function(){var e=this.$store.state.curTransform;return e},materialType:function(){return this.$store.state.materialType},material:function(){return this.$store.state.curMaterial},drawer:function(){return this.$store.state.drawer},curDragType:function(){return this.$store.state.curDragType},aim:function(){return"light"==this.$store.state.curDragType?"LightInfo":"MeshInfo"}},methods:{handleClose:function(){this.$store.commit("changeDrawer",!1)},handleCopy:function(){G.ins.send(G.COPY_ITEM)},handleDelete:function(){this.$store.commit("changeDrawer",!1),G.ins.send(G.DELETE_ITEM)},handleCollapse:function(e){console.log(e)},handleChange:function(e){}}},It=xt,Et=(n("277d"),Object(o["a"])(It,et,tt,!1,null,"4f22342c",null)),Ot=Et.exports,jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"texture-view"},[a("el-dialog",{attrs:{title:"选择贴图",visible:e.visible},on:{close:e.handleClose}},e._l(e.list,function(t,n){return a("div",{key:n,staticClass:"block",on:{click:function(a){return e.handleChange(t.url)}}},[a("div",{staticClass:"img",style:{"background-image":"url("+t.url+")"}}),a("div",{staticClass:"name"},[e._v(e._s(t.name))])])}),0)],1)},Lt=[],St={data:function(){return{list:[]}},components:{},computed:{visible:function(){return this.$store.state.texureViewVisible},chooseImage:function(){return this.$store.state.changeChooseImage}},mounted:function(){var e=this;this.$axios.get("asset/texture/list.json").then(function(t){e.list=t.data})},methods:{handleClose:function(){this.$store.commit("changeTexureViewVisible",!1)},handleChoose:function(e){this.$store.commit("changeCurMaterial",this.list[e].param)},handleChange:function(e){var t=this.$store.state.texureViewType;G.ins.send(G.CHANGE_ITEM_PARAM,{name:t,value:e}),this.$store.commit("changeTexureViewVisible",!1)}}},Vt=St,$t=(n("5553"),Object(o["a"])(Vt,jt,Lt,!1,null,"0b9c5d66",null)),Gt=$t.exports,Pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"custom-geometry"},[a("el-dialog",{attrs:{title:"自定义物体",visible:e.visible},on:{close:e.handleClose}},[a("div",{staticClass:"label"},[e._v("position: 例如:[1,2,3]")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.position,expression:"position"}],staticClass:"txt",attrs:{rows:"4"},domProps:{value:e.position},on:{input:function(t){t.target.composing||(e.position=t.target.value)}}}),a("div",{staticClass:"label"},[e._v("normal: 例如:[1,2,3]")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.normal,expression:"normal"}],staticClass:"txt",attrs:{rows:"4"},domProps:{value:e.normal},on:{input:function(t){t.target.composing||(e.normal=t.target.value)}}}),a("div",{staticClass:"label"},[e._v("uv: 例如:[1,2,3]")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.uv,expression:"uv"}],staticClass:"txt",attrs:{rows:"4"},domProps:{value:e.uv},on:{input:function(t){t.target.composing||(e.uv=t.target.value)}}}),a("div",{staticClass:"label"},[e._v("index: 例如:[1,2,3]")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.index,expression:"index"}],staticClass:"txt",attrs:{rows:"4"},domProps:{value:e.index},on:{input:function(t){t.target.composing||(e.index=t.target.value)}}}),a("el-button",{staticClass:"btn",attrs:{type:"primary",icon:"el-icon-position"},on:{click:e.handleSure}},[e._v("确定")])],1)],1)},Bt=[],Nt={data:function(){return{position:"",normal:"",uv:"",index:""}},components:{},computed:{visible:function(){return this.$store.state.customGeometryVisible}},mounted:function(){},methods:{handleSure:function(){this.$store.commit("changeCustomGeometryVisible",!1),G.ins.send(G.CUSTOM_GEOMETRY,{position:this.position,normal:this.normal,uv:this.uv,index:this.index})},handleClose:function(){this.$store.commit("changeCustomGeometryVisible",!1)}}},At=Nt,Dt=(n("ac60"),Object(o["a"])(At,Pt,Bt,!1,null,"7d49b1b5",null)),Rt=Dt.exports,zt=function(e){function t(){return Object(f["a"])(this,t),Object(p["a"])(this,Object(v["a"])(t).apply(this,arguments))}return Object(g["a"])(t,e),t}(y["d"]);zt=b["a"]([Object(y["a"])({components:{HelloWorld:x,Stage:ee,LeftSide:Ze,RightSide:Ot,TextureView:Gt,CustomGeometry:Rt}})],zt);var Ht=zt,Ft=Ht,Yt=Object(o["a"])(Ft,h,d,!1,null,null,null),Wt=Yt.exports;i["default"].use(m["a"]);var Ut=new m["a"]({mode:"hash",base:"",routes:[{path:"/",redirect:"/home"},{path:"/home",component:Wt},{path:"/about",name:"about",component:function(){return n.e("about").then(n.bind(null,"f820"))}}]}),Xt=n("2f62");i["default"].use(Xt["a"]);var Jt=new Xt["a"].Store({state:{dragItem:Object,curParam:Object,curMaterial:Object,curTransform:{},isDrag:!1,drawer:!1,texureViewVisible:!1,customGeometryVisible:!1,texureViewType:null,materialType:null,chooseImage:null,curDragType:null,curItemName:null,itemInfo:null,fog:{color:"#ff0000",visible:!1,near:.1,far:60}},mutations:{changeDrag:function(e,t){e.dragItem=t},changeCurParams:function(e,t){e.curParam=t},changeCurTransform:function(e,t){e.curTransform=t},changeCurMaterial:function(e,t){e.curMaterial=t},changeDrawer:function(e,t){e.drawer=t},changeTexureViewVisible:function(e,t){e.texureViewVisible=t},changeChooseImage:function(e,t){e.chooseImage=t},changeTexureViewType:function(e,t){e.texureViewType=t},changeMaterialType:function(e,t){e.materialType=t},changeCurDragType:function(e,t){e.curDragType=t},changeCurItemName:function(e,t){e.curItemName=t},changeFog:function(e,t){e.fog=t},changeItemInfo:function(e,t){e.itemInfo=t},changeCustomGeometryVisible:function(e,t){e.customGeometryVisible=t}},actions:{}}),qt=n("5c96"),Qt=n.n(qt),Kt=n("bc3a"),Zt=n.n(Kt);n("0fae");i["default"].use(Qt.a),i["default"].config.productionTip=!1,i["default"].prototype.$axios=Zt.a,new i["default"]({router:Ut,store:Jt,render:function(e){return e(u)}}).$mount("#app")},cfae:function(e,t,a){"use strict";var n=a("4918"),i=a.n(n);i.a},d318:function(e,t,a){},d3e9:function(e,t,a){"use strict";var n=a("3356"),i=a.n(n);i.a},d99b:function(e,t,a){"use strict";var n=a("b8bc"),i=a.n(n);i.a},fa1a:function(e,t,a){"use strict";var n=a("7afc"),i=a.n(n);i.a},fe0d:function(e,t,a){}});
//# sourceMappingURL=app.d5b1a66e.js.map